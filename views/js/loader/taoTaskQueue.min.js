function _typeof2(obj){return _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof2(obj)}define("core/format",["lodash"],function(_){'use strict';function format(message){var replacements=Array.prototype.slice.call(arguments,1);return _.reduce(message.match(pattern),function(acc,match,index){var replacement="";if(void 0!==replacements[index]){switch(match){case"%d":replacement=+replacements[index];break;case"%j":try{replacement=JSON.stringify(replacements[index]).replace(/"/g,"")}catch(e){}break;default:replacement=replacements[index];}message=message.replace(match,replacement)}return message},message)}_=_&&_.hasOwnProperty("default")?_["default"]:_;var pattern=/(%[sdj])/g;return format}),define("core/promise",[],function(){'use strict';return Promise}),function(global,factory){"object"===("undefined"==typeof exports?"undefined":_typeof2(exports))&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("lib/uuid",factory):(global=global||self,global.uuid=factory())}(this,function(){'use strict';var CHARS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];return function(len,radix){var chars=CHARS,uuid=[],i,r;if(radix=radix||chars.length,len)for(i=0;i<len;i++)uuid[i]=chars[0|Math.random()*radix];else for(uuid[8]=uuid[13]=uuid[18]=uuid[23]="-",uuid[14]="4",i=0;36>i;i++)uuid[i]||(r=0|16*Math.random(),uuid[i]=chars[19===i?8|3&r:r]);return uuid.join("")}}),define("core/logger/api",["lodash","core/format","core/promise"],function(_,format,Promise){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_,format=format&&format.hasOwnProperty("default")?format["default"]:format,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise;var defaultLevel="info",levels={fatal:60,error:50,warn:40,info:30,debug:20,trace:10},logQueue=[],getLevel=function(level){return"undefined"==typeof level||_.isString(level)&&!_.has(levels,level)?defaultLevel:_.isNumber(level)?_.findKey(levels,function(l){return l===level})||defaultLevel:level},getLevelNum=function(level){return _.isString(level)&&_.has(levels,level)?levels[level]:_.isNumber(level)&&_.contains(levels,level)?level:levels[defaultLevel]},checkMinLevel=function(minLevel,level){return getLevelNum(level)>=getLevelNum(minLevel)},loggerFactory=function loggerFactory(name,minLevel,fields){var baseRecord,logger;if(!_.isString(name)||_.isEmpty(name))throw new TypeError("A logger needs a name");return _.isPlainObject(minLevel)&&"undefined"==typeof field&&(fields=minLevel,minLevel=defaultLevel),baseRecord=_.defaults(fields||{},{name:name,pid:1,hostname:navigator.userAgent}),logger={log:function(level,recordFields,message){var rest=[],time=new Date().toISOString(),record,err;if(!1!==loggerFactory.providers&&checkMinLevel(minLevel||defaultLevel,level))return _.isString(recordFields)||recordFields instanceof Error?(message=recordFields,recordFields={},rest=[].slice.call(arguments,2)):rest=[].slice.call(arguments,3),record={level:getLevel(level),v:0,time:time},checkMinLevel(levels.error,level)||message instanceof Error?(message instanceof Error?err=message:(message=_.isObject(message)?JSON.stringify(message):message,err=new Error(message)),record.msg=err.message,record.err=err):record.msg=format.apply(null,[message].concat(rest)),_.merge(record,baseRecord,recordFields),logQueue.push(record),loggerFactory.flush(),this},level:function(value){return"undefined"==typeof value?getLevel(minLevel):(minLevel=getLevelNum(value),this)},child:function(childFields){return loggerFactory(name,minLevel,_.defaults(childFields,baseRecord))}},_.reduce(levels,function(target,level,levelName){return target[levelName]=_.partial(logger.log,level),target},logger)};return loggerFactory.levels=levels,loggerFactory.providers=!1,loggerFactory.load=function(providerConfigs){var self=this,modules=[];return this.providers=[],new Promise(function(resolve,reject){_.forEach(providerConfigs,function(providerConfig,providerName){modules.push(providerName)}),require(modules,function(){var loadedProviders=[].slice.call(arguments);_.forEach(loadedProviders,function(provider,moduleKey){try{self.register(provider,providerConfigs[modules[moduleKey]])}catch(err){reject(err)}}),self.flush(),resolve()},reject)})},loggerFactory.register=function(provider,providerConfig){if(!_.isPlainObject(provider)||!_.isFunction(provider.log))throw new TypeError("A log provider is an object with a log method");provider.checkMinLevel=checkMinLevel,_.isFunction(provider.setConfig)&&provider.setConfig(providerConfig),this.providers=this.providers||[],this.providers.push(provider)},loggerFactory.flush=function(){_.isArray(this.providers)&&0<this.providers.length&&(_.forEach(logQueue,function(message){_.forEach(loggerFactory.providers,function(provider){provider.log.call(provider,message)})}),logQueue=[])},loggerFactory.setDefaultLevel=function(level){return defaultLevel=getLevel(level),defaultLevel},loggerFactory}),define("core/logger",["lodash","module","core/logger/api"],function(_,module,loggerFactory){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_,module=module&&module.hasOwnProperty("default")?module["default"]:module,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory["default"]:loggerFactory;var defaultConfig={level:loggerFactory.levels.warn,loggers:{"core/logger/console":{level:"warn"}}},config=_.defaults(module.config()||{},defaultConfig),logger=loggerFactory("core/logger");return loggerFactory.setDefaultLevel(config.level),loggerFactory.load(config.loggers),window.onerror=function(msg,url,line,col){logger.error("Caught[via window.onerror]: '"+msg+"' from "+url+":"+line+":"+col)},window.setTaoLogLevel=function(level){return loggerFactory.setDefaultLevel(level)},loggerFactory}),define("core/eventifier",["lodash","core/promise","lib/uuid","core/logger"],function(_,Promise,uuid,loggerFactory){'use strict';function getEventNames(eventNames){return!_.isString(eventNames)||_.isEmpty(eventNames)?[]:_(eventNames.split(/\s/g)).compact().uniq().value()}function getName(eventName){return-1<eventName.indexOf(".")?eventName.substr(0,eventName.indexOf(".")):eventName}function getNamespace(eventName){return-1<eventName.indexOf(".")?eventName.substr(eventName.indexOf(".")+1):"@"}function getHandlerObject(){return{before:[],between:[],after:[]}}function eventifier(target){var eventHandlers={},getHandlers=function(eventName,type){var name=getName(eventName),ns=getNamespace(eventName);return type=type||"between",eventHandlers[ns]=eventHandlers[ns]||{},eventHandlers[ns][name]=eventHandlers[ns][name]||getHandlerObject(),eventHandlers[ns][name][type]},eventApi={on:function(eventNames,handler){return _.isFunction(handler)&&_.forEach(getEventNames(eventNames),function(eventName){getHandlers(eventName).push(handler)}),this},off:function(eventNames){return _.forEach(getEventNames(eventNames),function(eventName){var name=getName(eventName),ns=getNamespace(eventName),offNamespaces;ns&&!name?"*"===ns?(offNamespaces={},offNamespaces["@"]=eventHandlers["@"],eventHandlers=offNamespaces):eventHandlers[ns]={}:_.forEach(eventHandlers,function(nsHandlers,namespace){nsHandlers[name]&&("@"===ns||ns===namespace)&&(nsHandlers[name]=getHandlerObject())})}),this},removeAllListeners:function(){return eventHandlers={},this},trigger:function(eventNames){function triggerAllHandlers(allHandlers,name,ns){var event={name:name,namespace:ns};allHandlers.before.length?triggerBefore(allHandlers.before,event).then(function(){triggerBetween(allHandlers,event)}).catch(function(err){logHandlerStop("before",event,err)}):triggerBetween(allHandlers,event)}function triggerBefore(handlers,event){var beforeArgs=args.slice(),pHandlers;return beforeArgs.unshift(event),pHandlers=handlers.map(function(handler){var value=!shouldStop(event.name)&&handler.apply(self,beforeArgs);return!1===value?Promise.reject():value}),Promise.all(pHandlers)}function triggerBetween(allHandlers,event){shouldStop(event.name)?logHandlerStop("before",event):triggerHandlers(allHandlers.between,event).then(function(){triggerAfter(allHandlers.after,event)}).catch(function(err){logHandlerStop("on",event,err)})}function triggerAfter(handlers,event){shouldStop(event.name)?logHandlerStop("on",event):triggerHandlers(handlers,event).then(function(){shouldStop(event.name)&&logHandlerStop("after",event)}).catch(function(err){logHandlerStop("after",event,err)})}function triggerHandlers(handlers,event){var pHandlers;return pHandlers=handlers.map(function(handler){return shouldStop(event.name)?Promise.reject():handler.apply(self,args)}),Promise.all(pHandlers)}function logHandlerStop(stoppedIn,event,err){err instanceof Error&&logger.error(err),logger.trace({err:err,event:event.name,stoppedIn:stoppedIn},event.name+" handlers stopped")}function shouldStop(name){return stoppedEvents[name]}var self=this,args=[].slice.call(arguments,1);return stoppedEvents={},_.forEach(getEventNames(eventNames),function(eventName){var ns=getNamespace(eventName),name=getName(eventName),mergedHandlers=_(eventHandlers).filter(function(nsHandlers,namespace){return nsHandlers[name]&&("@"===ns||ns===namespace||"*"===namespace)}).reduce(function(acc,nsHandlers){return acc.before=acc.before.concat(nsHandlers[name].before),acc.between=acc.between.concat(nsHandlers[name].between),acc.after=acc.after.concat(nsHandlers[name].after),acc},getHandlerObject());logger.trace({event:eventName,args:args},"trigger %s",eventName),mergedHandlers&&triggerAllHandlers(mergedHandlers,name,ns)}),this},before:function(eventNames,handler){return _.isFunction(handler)&&_.forEach(getEventNames(eventNames),function(eventName){getHandlers(eventName,"before").push(handler)}),this},after:function(eventNames,handler){return _.isFunction(handler)&&_.forEach(getEventNames(eventNames),function(eventName){getHandlers(eventName,"after").push(handler)}),this},stopEvent:function(name){_.isString(name)&&!_.isEmpty(name.trim())&&(stoppedEvents[name.trim()]=!0)},spread:function(destination,eventNames){var self=this;return destination&&_.isFunction(destination.trigger)&&(_.isString(eventNames)&&(eventNames=getEventNames(eventNames)),_.forEach(eventNames,function(eventName){self.on(eventName,function(){var args=[eventName].concat([].slice.call(arguments));destination.trigger.apply(destination,args)})})),this}},targetName,logger,stoppedEvents;return target=target||{},targetName=target.name||target.id||target.serial||uuid(6),logger=eventifierLogger.child({target:targetName}),_(eventApi).functions().forEach(function(method){_.isFunction(target[method])&&eventifierLogger.warn("The target object has already a method named "+method,target),target[method]=function(){var args=[].slice.call(arguments);return eventApi[method].apply(target,args)}}),target}_=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,uuid=uuid&&uuid.hasOwnProperty("default")?uuid["default"]:uuid,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory["default"]:loggerFactory;var eventifierLogger=loggerFactory("core/eventifier");return eventifier}),define("ui/hider",["jquery","core/eventifier"],function($){'use strict';function jqWrap(element){return element instanceof $?element:$(element)}$=$&&$.hasOwnProperty("default")?$["default"]:$;return{show:function(element){return jqWrap(element).removeClass("hidden")},hide:function(element){return jqWrap(element).addClass("hidden")},toggle:function(element,state){return"undefined"!=typeof state&&(state=!state),jqWrap(element).toggleClass("hidden",state)},isHidden:function(element,real){var $elt=jqWrap(element);return real?$elt.hasClass("hidden")||"none"===$elt.css("display")||"hidden"===$elt.css("visibility"):$elt.hasClass("hidden")}}}),define("css!ui/component/css/components",[],function(){}),define("ui/component",["jquery","lodash","core/eventifier","handlebars","i18n","lib/dompurify/purify","css!ui/component/css/components.css"],function($$1,_,eventifier,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function defaultTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function delegatedResize(){var width=this.config.width,height=this.config.height,$container=this.getContainer(),$element=this.getElement();$container&&("auto"===width&&(width=$container.width()),"auto"===height&&(height=$container.height())),$element&&(_.isNumber(width)&&$element.css({width:"".concat(width,"px")}),_.isNumber(height)&&$element.css({height:"".concat(height,"px")})),this._width=width,this._height=height}function component(specs,defaults){var componentTpl=defaultTpl,componentState={},componentApi={init:function(config){return this.config=_(config||{}).omit(function(value){return null===value||"undefined"==typeof value}).defaults(defaults||{}).value(),componentState={},this.trigger("init"),this.config.renderTo&&($container=$$1(this.config.renderTo),this.render()),this},destroy:function(){return this.trigger("destroy"),this.$component&&this.$component.remove(),this.$component=null,componentState={},this},render:function(container){return container&&($container=$$1(container)),this.$component=$$1(componentTpl(this.config)),$container&&(this.config.replace&&$container.empty(),$container.append(this.$component)),this.setState("rendered",!0),delegatedResize.call(this),this.trigger("render",this.$component),this},setSize:function(width,height){return this.config.width=width,this.config.height=height,this.is("rendered")&&delegatedResize.call(this),this.trigger("setsize",width,height),this},getSize:function(){if(this.is("rendered"))return{width:this._width||0,height:this._height||0}},getOuterSize:function(includeMargin){var _Mathround=Math.round,$component;if(this.is("rendered"))return $component=this.getElement(),includeMargin=includeMargin||!1,{width:_Mathround($component.outerWidth(includeMargin)),height:_Mathround($component.outerHeight(includeMargin))}},show:function(){return this.trigger("show",this),this.setState("hidden",!1)},hide:function(){return this.trigger("hide",this),this.setState("hidden",!0)},enable:function(){return this.trigger("enable",this),this.setState("disabled",!1)},disable:function(){return this.trigger("disable",this),this.setState("disabled",!0)},is:function(state){return!!componentState[state]},setState:function(state,flag){return flag=!!flag,componentState[state]=flag,this.$component&&this.$component.toggleClass(state,flag),this.trigger("state",state,flag,this),this},getContainer:function(){return $container},getElement:function(){return this.$component},getTemplate:function(){return componentTpl},setTemplate:function(template){var tpl=template||defaultTpl;return componentTpl=tpl,_.isFunction(componentTpl)||(componentTpl=function(){return tpl}),this.trigger("template",componentTpl),this},getConfig:function(){return this.config||defaults||{}}},$container;return specs&&_(specs).functions().forEach(function(method){componentApi[method]=function(){return specs[method].apply(componentApi,_slice.call(arguments))}}),eventifier(componentApi)}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier["default"]:eventifier,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),"<div class=\"component\"></div>"}),_slice=[].slice;return component}),define("css!ui/badge/css/badge",[],function(){}),define("ui/badge/badge",["lodash","ui/hider","ui/component","handlebars","i18n","lib/dompurify/purify","css!ui/badge/css/badge.css"],function(_,hider,component,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function badgeTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function badgeFactory(config){var initConfig=_.defaults(config||{},_defaults);return component(badgeApi).setTemplate(badgeTpl).on("render",function(){this.update(this.config)}).init(initConfig)}_=_&&_.hasOwnProperty("default")?_["default"]:_,hider=hider&&hider.hasOwnProperty("default")?hider["default"]:hider,component=component&&component.hasOwnProperty("default")?component["default"]:component,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),"<div class=\"badge-component\">\n    <div class=\"loader\"></div>\n    <span class=\"badge-border\"></span>\n    <span class=\"badge\"></span>\n</div>"}),_defaults={loading:!1,type:"info",value:0},_allowedTypes=["success","warning","error","info"],badgeApi={update:function(config){var $component=this.getElement(),$border=$component.find(".badge-border"),$badge=$component.find(".badge").removeClass("badge-info badge-success badge-warning badge-error icon-result-ok"),$loader=$component.find(".loader"),displayValue;if(_.assign(this.config,config),this.config&&this.config.value){if(displayValue=parseInt(this.config.value,10),displayValue=99<displayValue?"99+":displayValue,-1===_allowedTypes.indexOf(this.config.type))throw new Error("Invalid badge type : ".this.config.type);$badge.addClass("badge-"+this.config.type).html(displayValue),this.config.loading?(hider.show($loader),hider.hide($border)):(hider.hide($loader),hider.show($border))}else hider.hide($loader),hider.hide($border),$badge.addClass("icon-result-ok").empty();return this}};return badgeFactory}),define("ui/transformer",["jquery","lodash","lib/unmatrix/unmatrix"],function($,_,_unmatrix){'use strict';function _normalizeTransforms(transforms){for(var xy=["translate","scale"],i=xy.length;i--;)transforms[xy[i]]&&(_.isArray(transforms[xy[i]])&&2===transforms[xy[i]].length?(transforms[xy[i]+"X"]=transforms[xy[i]][0],transforms[xy[i]+"Y"]=transforms[xy[i]][1]):(transforms[xy[i]+"X"]=transforms[xy[i]],transforms[xy[i]+"Y"]=transforms[xy[i]]),delete transforms[xy[i]]);return transforms}function _transform($elem,transforms){var cssObj={},defaults=_unmatrix("none"),classNames=[],oriTrans;transforms=_normalizeTransforms(transforms),$elem.data("oriTrans")||(oriTrans=_getTransformation($elem[0]),oriTrans.origin=_getTransformOrigin($elem[0]),$elem.data("oriTrans",oriTrans)),cssObj[prefix+"transform"]="",_.forIn(transforms,function(value,key){return!!_.isNaN(value)||void(value=parseFloat(value),$elem.data("oriTrans").obj[key]!==defaults[key]&&(-1<key.indexOf("scale")?value*=$elem.data("oriTrans").obj[key]:value+=$elem.data("oriTrans").obj[key]),void 0!==defaults[key]&&value!==defaults[key]&&(-1<key.indexOf("translate")?value+="px":("rotate"===key||-1<key.indexOf("skew"))&&(value+="deg"),cssObj[prefix+"transform"]+=key+"("+value+") ",classNames.push("transform-"+key.replace(/(X|Y)$/i,""))))}),cssObj[prefix+"transform"]=$.trim(cssObj[prefix+"transform"]),$elem.css(cssObj),$elem.removeClass("transform-translate transform-rotate transform-skew transform-scale"),$elem.addClass(_.unique(classNames).join(" ")),$elem.trigger("transform.transformer",transforms)}$=$&&$.hasOwnProperty("default")?$["default"]:$,_=_&&_.hasOwnProperty("default")?_["default"]:_,_unmatrix=_unmatrix&&_unmatrix.hasOwnProperty("default")?_unmatrix["default"]:_unmatrix;var vendorPrefixes=["webkit","ms"],prefix=function(){var i=vendorPrefixes.length,style=window.getComputedStyle(document.body,null);if(style.getPropertyValue("transform"))return"";for(;i--;)if(style[vendorPrefixes[i]+"Transform"]!==void 0)return"-"+vendorPrefixes[i]+"-"}(),_getTransformation=function(elem){var _style=window.getComputedStyle(elem,null),matrix=_style.getPropertyValue("transform")||_style.getPropertyValue("-webkit-transform")||_style.getPropertyValue("-ms-transform")||"none",obj=_unmatrix(matrix);return{matrix:matrix,obj:obj}},_getTransformOrigin=function(elem){var _style=window.getComputedStyle(elem,null);return _style.getPropertyValue("transform-origin")||_style.getPropertyValue("-webkit-transform-origin")||_style.getPropertyValue("-ms-transform-origin")||"50% 50% 0"};return{translate:function($elem,valueX,valueY){valueY=valueY||valueX,_transform($elem,{translateX:valueX,translateY:valueY})},translateXY:function($elem,valueX,valueY){_transform($elem,{translateX:valueX,translateY:valueY})},translateX:function($elem,value){_transform($elem,{translateX:value})},translateY:function($elem,value){_transform($elem,{translateY:value})},rotate:function($elem,value){_transform($elem,{rotate:value})},skew:function($elem,value){_transform($elem,{skew:value})},scale:function($elem,valueX,valueY){valueY=valueY||valueX,_transform($elem,{scaleX:valueX,scaleY:valueY})},scaleX:function($elem,value){_transform($elem,{scaleX:value})},scaleY:function($elem,value){_transform($elem,{scaleY:value})},reset:function($elem){var cssObj={};$elem.data("oriTrans")&&(cssObj[prefix+"transform"]=$elem.data("oriTrans").matrix,cssObj[prefix+"transform-origin"]=$elem.data("oriTrans").origin,$elem.css(cssObj),$elem.removeClass("transform-translate transform-rotate transform-skew transform-scale"),$elem.trigger("reset.transformer",$elem.data("oriTrans")))},getTransformation:function(elem){return elem instanceof $&&(elem=elem[0]),_getTransformation(elem)},setTransformOrigin:function($elem,valueX,valueY){var cssObj={};cssObj[prefix+"transform-origin"]=valueY||0===valueY?valueX+" "+valueY:valueX,$elem.css(cssObj)}}}),define("ui/component/placeable",["lodash","ui/transformer"],function(_,transformer){'use strict';function makePlaceable(component,config){return _.assign(component,placeableComponent),component.off(".makePlaceable").on("init.makePlaceable",function(){_.defaults(this.config,config||{},defaultConfig)}).on("render.makePlaceable",function(){var $element=this.getElement();$element.css({position:"absolute"}),this.resetPosition()})}_=_&&_.hasOwnProperty("default")?_["default"]:_,transformer=transformer&&transformer.hasOwnProperty("default")?transformer["default"]:transformer;var defaultConfig={initialX:0,initialY:0},placeableComponent={_translate:function(xOffsetAbsolute,yOffsetAbsolute){var $element=this.getElement();transformer.translateXY($element,xOffsetAbsolute,yOffsetAbsolute),this._translateX=xOffsetAbsolute,this._translateY=yOffsetAbsolute,this._x=xOffsetAbsolute+this.config.initialX,this._y=yOffsetAbsolute+this.config.initialY,this.trigger("move",this._x,this._y)},center:function(){var $container=this.getContainer(),$element=this.getElement(),centerX,centerY;return this.is("rendered")&&!this.is("disabled")&&$container.length&&(centerX=$container.width()/2-$element.width()/2,centerY=$container.height()/2-$element.height()/2,this.moveTo(centerX,centerY),this.trigger("center",centerX,centerY)),this},moveBy:function(xOffsetRelative,yOffsetRelative){var xOffsetAbsolute,yOffsetAbsolute;return this.is("rendered")&&!this.is("disabled")&&(xOffsetAbsolute=this._translateX+xOffsetRelative,yOffsetAbsolute=this._translateY+yOffsetRelative,this._translate(xOffsetAbsolute,yOffsetAbsolute)),this},moveTo:function(x,y){var xOffsetAbsolute,yOffsetAbsolute;return this.is("rendered")&&!this.is("disabled")&&(xOffsetAbsolute=x-this.config.initialX,yOffsetAbsolute=y-this.config.initialY,this._translate(xOffsetAbsolute,yOffsetAbsolute)),this},moveToX:function(x){return this.moveTo(x,this._y)},moveToY:function(y){return this.moveTo(this._x,y)},resetPosition:function(){var $element=this.getElement();return this.is("rendered")&&($element.css({left:this.config.initialX,top:this.config.initialY}),this._translate(0,0)),this},getPosition:function(){var position;return this.is("rendered")&&(position={x:this._x||0,y:this._y||0}),position}};return makePlaceable.isPlaceable=function(component){return Object.keys(placeableComponent).every(function(method){return"function"==typeof component[method]})},makePlaceable}),define("ui/component/alignable",["lodash","ui/component/placeable"],function(_,makePlaceable){'use strict';function makeAlignable(component,config){return _.assign(component,alignableComponent),makePlaceable.isPlaceable(component)||makePlaceable(component),component.off(".makeAlignable").on("init.makeAlignable",function(){_.defaults(this.config,config||{},defaultConfig)})}_=_&&_.hasOwnProperty("default")?_["default"]:_,makePlaceable=makePlaceable&&makePlaceable.hasOwnProperty("default")?makePlaceable["default"]:makePlaceable;var defaultConfig={},alignDefaults={hPos:"center",vPos:"center"},alignableComponent={alignWith:function($element,options){var alignedCoords=this._getAlignedCoords($element,options);return this.moveTo(alignedCoords.x,alignedCoords.y)},hAlignWith:function($element,hPos,hOrigin,hOffset){var alignedCoords=this._getAlignedCoords($element,{hPos:hPos,hOrigin:hOrigin,hOffset:hOffset});return this.moveToX(alignedCoords.x)},vAlignWith:function($element,vPos,vOrigin,vOffset){var alignedCoords=this._getAlignedCoords($element,{vPos:vPos,vOrigin:vOrigin,vOffset:vOffset});return this.moveToY(alignedCoords.y)},_getAlignedCoords:function($element,options){var $container=this.getContainer(),componentOuterSize,containerOffset,elementOffset,elementWidth,elementHeight,x,y,hPos,vPos,hOrigin,vOrigin;switch(options=options||{},componentOuterSize=this.getOuterSize(),containerOffset=$container.offset(),elementOffset=$element.offset(),elementWidth=$element.outerWidth(),elementHeight=$element.outerHeight(),hPos=options.hPos||alignDefaults.hPos,vPos=options.vPos||alignDefaults.vPos,hOrigin=options.hOrigin||this._getDefaultHOrigin(options.hPos),vOrigin=options.vOrigin||this._getDefaultVOrigin(options.vPos),x=elementOffset.left-containerOffset.left,y=elementOffset.top-containerOffset.top,hPos){case"center":{x+=elementWidth/2;break}case"right":{x+=elementWidth;break}}switch(hOrigin){case"center":{x-=componentOuterSize.width/2;break}case"right":{x-=componentOuterSize.width;break}}switch(x+=options.hOffset||0,vPos){case"center":{y+=elementHeight/2;break}case"bottom":{y+=elementHeight;break}}switch(vOrigin){case"center":{y-=componentOuterSize.height/2;break}case"bottom":{y-=componentOuterSize.height;break}}return y+=options.vOffset||0,{x:x,y:y}},_getDefaultHOrigin:function(hPos){var hOrigin;switch(hPos){default:case"center":{hOrigin="center";break}case"left":{hOrigin="right";break}case"right":{hOrigin="left";break}}return hOrigin},_getDefaultVOrigin:function(vPos){var vOrigin;switch(vPos){default:case"center":{vOrigin="center";break}case"top":{vOrigin="bottom";break}case"bottom":{vOrigin="top";break}}return vOrigin}};return makeAlignable}),define("css!ui/animable/absorbable/css/absorb",[],function(){}),define("ui/animable/absorbable/absorbable",["lodash","ui/component","ui/component/alignable","handlebars","i18n","lib/dompurify/purify","css!ui/animable/absorbable/css/absorb.css"],function(_,componentFactory,makeAlignable,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function absorbTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function makeAbsorbable(component,config){return _.assign(component,absorbableComponent),component.off(".makeAbsorbable").on("init.makeAbsorbable",function(){_.defaults(this.config,config||{},defaultConfig)})}_=_&&_.hasOwnProperty("default")?_["default"]:_,componentFactory=componentFactory&&componentFactory.hasOwnProperty("default")?componentFactory["default"]:componentFactory,makeAlignable=makeAlignable&&makeAlignable.hasOwnProperty("default")?makeAlignable["default"]:makeAlignable,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),"<div class=\"absorbable\"></div>"}),defaultConfig={animationDuration:1},absorbableComponent={absorb:function($target){var self=this,$component=this.getElement(),targetWidth=$target.width(),targetHeight=$target.height(),finalWidth=10,finalHeight=10,animationDuration=parseInt(this.config.animationDuration,10)||defaultConfig.animationDuration,animationStartOffset=10,animatedComponent=makeAlignable(componentFactory()).setTemplate(absorbTpl).init().render($component).setSize(targetWidth,targetHeight).alignWith($target,{hPos:"center",vPos:"center",hOrigin:"center",vOrigin:"center"});return"static"===$component.css("position")&&$component.css("position","relative"),new Promise(function(resolve){_.delay(function(){animatedComponent.getElement().addClass("animate").css({transitionDuration:animationDuration+"s"}),animatedComponent.setSize(finalWidth,finalHeight).alignWith($component,{hPos:"center",vPos:"center",hOrigin:"center",vOrigin:"center",hOffset:targetWidth/2-finalWidth/2,vOffset:targetHeight/2-finalHeight/2}),_.delay(function(){animatedComponent.destroy(),resolve(self)},1e3*animationDuration+animationStartOffset)},animationStartOffset)})},absorbBurst:function($target,delayArray){var animations=[],self=this;return delayArray=_.isArray(delayArray)?delayArray:[0],_.forEach(delayArray,function(startTimeOffset){animations.push(new Promise(function(resolve){_.delay(function(){self.absorb($target).then(resolve)},startTimeOffset)}))}),Promise.all(animations)}};return makeAbsorbable}),define("css!ui/animable/pulsable/css/pulse",[],function(){}),define("ui/animable/pulsable/pulsable",["lodash","ui/component","ui/component/alignable","handlebars","i18n","lib/dompurify/purify","css!ui/animable/pulsable/css/pulse.css"],function(_,componentFactory,makeAlignable,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function pulseTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function makePulsable(component,config){return _.assign(component,pulsableComponent),component.off(".makePulsable").on("init.makePulsable",function(){_.defaults(this.config,config||{},defaultConfig)})}_=_&&_.hasOwnProperty("default")?_["default"]:_,componentFactory=componentFactory&&componentFactory.hasOwnProperty("default")?componentFactory["default"]:componentFactory,makeAlignable=makeAlignable&&makeAlignable.hasOwnProperty("default")?makeAlignable["default"]:makeAlignable,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),"<div class=\"pulsable animate\"></div>"}),defaultConfig={pulseCount:3},pulsableComponent={pulse:function(pulseCount){var self=this,$component,pulseNb,animatedComponent;return this.config&&this.is("rendered")?($component=this.getElement(),"static"===$component.css("position")&&$component.css("position","relative"),pulseNb=parseInt(pulseCount||this.config.pulseCount||defaultConfig.pulseCount,10),animatedComponent=makeAlignable(componentFactory()).setTemplate(pulseTpl).init().render($component).alignWith($component,{hPos:"center",vPos:"center",hOrigin:"center",vOrigin:"center"}),new Promise(function(resolve){_.delay(function(){animatedComponent.destroy(),resolve(self)},1e3*pulseNb)})):Promise.resolve(this)}};return makePulsable}),define("tpl!taoTaskQueue/component/listing/tpl/element",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing,stack1,helper,options;return buffer+="<div class=\"task-element ",(helper=helpers.status)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.status,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\">\n    <div class=\"container-icon\">\n        <div class=\"shape\">\n            <span class=\"",(helper=helpers.icon)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.icon,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"/>\n        </div>\n    </div>\n    <div class=\"container-text\">\n        <div class=\"label\">",(helper=helpers.taskLabel)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.taskLabel,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</div>\n        <div class=\"time\">",(helper=helpers.time)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.time,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</div>\n    </div>\n    <div class=\"action-group action-top\">\n        <span data-role=\"remove\" class=\"icon-result-nok\" title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"remove",options):helperMissing.call(depth0,"__","remove",options)))+"\"/>\n    </div>\n    <div class=\"action-group action-bottom\">\n        <span data-role=\"notify\" class=\"icon-preview\" title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"notify me when done",options):helperMissing.call(depth0,"__","notify me when done",options)))+"\"/>\n        <span data-role=\"download\" class=\"icon-download\" title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"download",options):helperMissing.call(depth0,"__","download",options)))+"\"/>\n        <span data-role=\"redirect\" class=\"icon-external\" title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"go to resource",options):helperMissing.call(depth0,"__","go to resource",options)))+"\"/>\n        <span data-role=\"report\" class=\"icon-document\" title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"see report",options):helperMissing.call(depth0,"__","see report",options)))+"\"/>\n    </div>\n</div>",buffer})}),define("css!taoTaskQueue/component/listing/css/element",[],function(){}),define("taoTaskQueue/component/listing/element",["jquery","lodash","i18n","moment","ui/component","ui/hider","tpl!taoTaskQueue/component/listing/tpl/element","css!taoTaskQueue/component/listing/css/element"],function($,_,__,moment,component,hider,elementTpl){'use strict';var _defaults={},_allowedStatus=["in_progress","failed","completed"],_categoryMap={import:"import",export:"export",delivery_comp:"delivery",transfer:"connect",create:"magicwand",update:"edit",delete:"bin"},_statusIcon={in_progress:"property-advanced",completed:"result-ok",failed:"result-nok"},getLabelString=function(data){return data.taskLabel},getFormattedTime=function(from,elapsed){return moment.unix(from).from(moment.unix(parseInt(from,10)+parseInt(elapsed,10)))},getTimeString=function(data){switch(data.status){case"created":case"in_progress":return __("Started %s",getFormattedTime(data.createdAt,data.createdAtElapsed));case"completed":return __("Completed %s",getFormattedTime(data.updatedAt,data.updatedAtElapsed));case"failed":return __("Failed %s",getFormattedTime(data.updatedAt,data.updatedAtElapsed));default:return"";}},getIcon=function(data){var icon;if(!_.isPlainObject(data))throw new Error("invalid data");return icon=data.category&&_categoryMap[data.category]?_categoryMap[data.category]:data.status&&_statusIcon[data.status]?_statusIcon[data.status]:_statusIcon.in_progress,"icon-"+icon},taskElementApi={getId:function(){if(this.data&&this.data.id)return this.data.id},getStatus:function(){if(this.data&&this.data.status)return this.data.status},getData:function(){return this.data},update:function(data){var $container=this.getElement();return _.assign(this.data||{},data),$container.find(".shape > span").removeAttr("class").addClass(getIcon(this.data)),$container.find(".label").html(getLabelString(this.data)),$container.find(".time").html(getTimeString(this.data)),this.setStatus(this.data.status),hider.toggle($container.find(".action-bottom [data-role=\"download\"]"),this.data.hasFile),hider.toggle($container.find(".action-bottom [data-role=\"redirect\"]"),!!this.data.redirectUrl),this.trigger("update"),this},highlight:function(){var $container=this.getElement();return $container.addClass("highlight"),_.delay(function(){$container.removeClass("highlight")},500),this},setStatus:function(status){var self=this;if(!status)throw new Error("status should not be empty");if(-1!==["created"].indexOf(status)&&(status="in_progress"),-1===_allowedStatus.indexOf(status))throw new Error("unknown status "+status);return this.is(status)||(_.forEach(_.without(_allowedStatus,status),function(st){self.setState(st,!1)}),this.setState(status,!0)),this}};return function(config,data){var initConfig=_.defaults(config||{},_defaults);return component(taskElementApi).setTemplate(elementTpl).on("init",function(){this.data=data||{}}).on("render",function(){var self=this,$component=this.getElement();this.update(data),$component.find("[data-role=\"download\"]").click(function(){self.trigger("download")}),$component.find("[data-role=\"remove\"]").click(function(){self.trigger("remove")}),$component.find("[data-role=\"report\"]").click(function(){self.trigger("report")}),$component.find("[data-role=\"redirect\"]").click(function(){self.trigger("redirect")})}).init(initConfig)}}),define("ui/report",["jquery","lodash","ui/component","handlebars","i18n","lib/dompurify/purify"],function($$1,_,component,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function layoutTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function feedbackTpl(data,options,asString){var html=Template$1(data,options);return asString||!0?html:$(html)}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,component=component&&component.hasOwnProperty("default")?component["default"]:component,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program3(depth0,data){var buffer="",helper,options;return buffer+="\n    <label class=\"fold pseudo-label-box\">\n        <span class=\"check-txt hide\">"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Hide detailed report",options):helperMissing.call(depth0,"__","Hide detailed report",options)))+"</span>\n        <span class=\"check-txt show\">"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Show detailed report",options):helperMissing.call(depth0,"__","Show detailed report",options)))+"</span>\n        <input type=\"checkbox\"/>\n        <span class=\"icon-checkbox\"></span>\n    </label>\n    ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,self=this,stack1,helper;return buffer+="<div class=\"component-report",stack1=helpers["if"].call(depth0,depth0&&depth0.noBorder,{hash:{},inverse:self.noop,fn:self.program(1,function(){return" no-border"},data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\">\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.detailsButtonVisible,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    <div class=\"content\">",(helper=helpers.content)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.content,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</div>\n</div>",buffer});Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template$1=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program7(depth0){var buffer="",stack1;return buffer+="\n        ",stack1="function"===_typeof2(depth0)?depth0.apply(depth0):depth0,(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    ",buffer}function program9(depth0,data){var buffer="",stack1,helper;return buffer+="\n        <button data-trigger=\"",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" class=\"action btn-info\" title=\"",(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"><span class=\"icon-",(helper=helpers.icon)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.icon,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"></span>",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</button>\n        ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing,stack1,helper,options;return buffer+="<div class=\"feedback-",(helper=helpers.type)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.type,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+" ",stack1=helpers["if"].call(depth0,depth0&&depth0.hasChildren,{hash:{},inverse:self.program(3,function(){return"leaf"},data),fn:self.program(1,function(){return"hierarchical"},data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\">\n    <span class=\"icon-",(helper=helpers.type)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.type,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1),stack1=helpers["if"].call(depth0,depth0&&depth0.hasChildren,{hash:{},inverse:self.noop,fn:self.program(5,function(){return" hierarchical-icon"},data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\"></span>\n    <div class=\"message\">",stack1=(helper=helpers.dompurify||depth0&&depth0.dompurify,options={hash:{},data:data},helper?helper.call(depth0,depth0&&depth0.message,options):helperMissing.call(depth0,"dompurify",depth0&&depth0.message,options)),(stack1||0===stack1)&&(buffer+=stack1),buffer+="</div>\n    ",stack1=helpers.each.call(depth0,depth0&&depth0.children,{hash:{},inverse:self.noop,fn:self.program(7,program7,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    <div class=\"actions\">\n        ",stack1=helpers.each.call(depth0,depth0&&depth0.actions,{hash:{},inverse:self.noop,fn:self.program(9,program9,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n</div>",buffer}),_defaults={showDetailsButton:!0,actions:[]},authorizedTypes=["success","info","warning","error"],_renderFeebacks=function _renderFeebacks(data,actions){var children=[];if(!data.type||-1===authorizedTypes.indexOf(data.type))throw new TypeError("Unkown report type: "+data.type);return _.isArray(data.children)&&data.children.length&&_.each(data.children,function(child){children.push(_renderFeebacks(child))}),data.hasChildren=0<children.length,data.children=children,data.actions=actions,feedbackTpl(data)},report={isDetailed:function(){return this.is("detailed")},showDetails:function(){return this.is("rendered")&&(this.setState("detailed",!0),this.getElement().find(".fold input").prop("checked",!0),this.trigger("showDetails")),this},hideDetails:function(){return this.is("rendered")&&(this.setState("detailed"),this.getElement().find(".fold input").prop("checked",!1),this.trigger("hideDetails")),this}},reportComponentFactory=function(config,data){var initConfig=_.defaults(config||{},_defaults);return data&&_.isArray(data.children)&&data.children.length&&(initConfig.detailsButtonVisible=initConfig.showDetailsButton),component(report).setTemplate(layoutTpl).on("render",function(){var self=this,$content=this.getElement().find(".content"),$checkbox=this.getElement().find(".fold input");$content.append(_renderFeebacks(_.cloneDeep(data),this.config.actions)),$content.on("click",".action",function(){var actionId=$$1(this).data("trigger");self.trigger("action-"+actionId),self.trigger("action",actionId)}),$checkbox.on("change",_.throttle(function(){self.isDetailed()?self.hideDetails():self.showDetails()},100))}).init(initConfig)};return reportComponentFactory}),define("tpl!taoTaskQueue/component/listing/tpl/report",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,helper,options;return buffer+="<div class=\"task-detail-element\">\n    <div class=\"detail-description\">\n        <span class=\"label\"></span>\n        <span class=\"time\"></span>\n    </div>\n    <div class=\"action-group action-top\">\n        <span data-role=\"close\" class=\"icon-compress\" title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"close report",options):helperMissing.call(depth0,"__","close report",options)))+"\"/>\n    </div>\n    <div class=\"detail-body\">\n    </div>\n    <div class=\"no-detail\">\n        <span class=\"message\">"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"No report available",options):helperMissing.call(depth0,"__","No report available",options)))+"</span>\n    </div>\n</div>",buffer})}),define("css!taoTaskQueue/component/listing/css/report",[],function(){}),define("taoTaskQueue/component/listing/report",["jquery","lodash","i18n","moment","ui/component","ui/hider","ui/report","tpl!taoTaskQueue/component/listing/tpl/report","css!taoTaskQueue/component/listing/css/report"],function($,_,__,moment,component,hider,reportFactory,elementTpl){'use strict';var _defaults={},reportElementApi={update:function(data){var $component=this.getElement();$component.find(".label").html(data.taskLabel),data.report&&_.isArray(data.report.children)&&data.report.children.length?(this.setState("noreport",!1),reportFactory({replace:!0},data.report.children[0]).render($component.find(".detail-body"))):this.setState("noreport",!0)}};return function(config,data){var initConfig=_.defaults(config||{},_defaults);return component(reportElementApi).setTemplate(elementTpl).on("render",function(){var self=this,$component=this.getElement();this.update(data),$component.find("[data-role=\"close\"]").click(function(){self.trigger("close")})}).init(initConfig)}}),define("tpl!taoTaskQueue/component/listing/tpl/list",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing,stack1,helper,options;return buffer+="<div class=\"task-listing\">\n    <div class=\"box\">\n        <div class=\"arrow\"></div>\n        <div class=\"description\">",(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</div>\n        <div class=\"empty-placeholder\">",(helper=helpers.emptyText)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.emptyText,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</div>\n        <ul class=\"task-list plain\"></ul>\n        <div class=\"clear-box\">\n            <a class=\"clear-all\" href=\"#\" title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Clear all finished tasks",options):helperMissing.call(depth0,"__","Clear all finished tasks",options)))+"\">"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Clear all finished",options):helperMissing.call(depth0,"__","Clear all finished",options)))+"</a>\n        </div>\n        <div class=\"view-detail\"></div>\n    </div>\n</div>",buffer})}),define("tpl!taoTaskQueue/component/listing/tpl/elementWrapper",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,stack1,helper;return buffer+="<li data-id=\"",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"></li>",buffer})}),define("css!taoTaskQueue/component/listing/css/list",[],function(){}),define("taoTaskQueue/component/listing/list",["jquery","lodash","i18n","ui/component","taoTaskQueue/component/listing/element","tpl!taoTaskQueue/component/listing/tpl/list","tpl!taoTaskQueue/component/listing/tpl/elementWrapper","css!taoTaskQueue/component/listing/css/list"],function($,_,__,component,listElementFactory,listTpl,elementWrapperTpl){'use strict';var _defaults={title:"Task List",emptyText:__("The list is currently empty.")},listApi={removeElement:function(listElement){return listElement.destroy(),this.getElement().find("ul li[data-id=\""+listElement.getId()+"\"]").remove(),this},insertElement:function(listElement){var id=listElement.getId(),$li=$(elementWrapperTpl({id:id}));return this.getElement().find("ul").prepend($li),listElement.render($li),this},setDetail:function(detailElement,show){return detailElement.render(this.getElement().find(".view-detail")),show&&this.setState("detail-view",!0),this},hideDetail:function(){return this.setState("detail-view",!1),this},scrollToTop:function(){return this.getElement().find(".task-list").get(0).scrollTo(0,0),this},animateInsertion:function(listElement){var $listElement=listElement.getElement(),$container=$listElement.parent();return $container.addClass("inserting"),$listElement.addClass("new-element"),_.delay(function(){$container.removeClass("inserting"),_.delay(function(){$listElement.removeClass("new-element")},400)},100),this}};return function(config){var initConfig=_.defaults(config||{},_defaults);return component(listApi).setTemplate(listTpl).on("render",function(){var self=this;this.getElement().find(".clear-all").on("click",function(e){e.preventDefault(),self.trigger("clearall")})}).init(initConfig)}}),define("tpl!taoTaskQueue/component/manager/tpl/manager",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,helper,options;return buffer+="<div class=\"task-manager-container\" title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Background tasks",options):helperMissing.call(depth0,"__","Background tasks",options)))+"\">\n</div>",buffer})}),define("css!taoTaskQueue/component/manager/css/manager",[],function(){}),define("taoTaskQueue/component/manager/manager",["jquery","lodash","i18n","layout/loading-bar","ui/hider","ui/component","ui/badge/badge","ui/component/alignable","ui/animable/absorbable/absorbable","ui/animable/pulsable/pulsable","taoTaskQueue/component/listing/element","taoTaskQueue/component/listing/report","taoTaskQueue/component/listing/list","tpl!taoTaskQueue/component/manager/tpl/manager","css!taoTaskQueue/component/manager/css/manager"],function($,_,__,loadingBar,hider,component,badgeFactory,makeAlignable,makeAbsorbable,makePulsable,listElementFactory,reportElementFactory,taskListFactory,managerTpl){'use strict';var getBadgeDataFromStatus=function(tasksStatuses){var total=0,data={loading:!1};if(tasksStatuses)return tasksStatuses.numberOfTasksInProgress&&(total+=parseInt(tasksStatuses.numberOfTasksInProgress,10),data.type="info",data.loading=0<tasksStatuses.numberOfTasksInProgress),tasksStatuses.numberOfTasksCompleted&&(total+=parseInt(tasksStatuses.numberOfTasksCompleted,10),data.type="success"),tasksStatuses.numberOfTasksFailed&&(total+=parseInt(tasksStatuses.numberOfTasksFailed,10),data.type="success"===data.type?"warning":"error"),data.value=total,data},getBadgeDataFromElements=function(elements){var statusMap={in_progress:"numberOfTasksInProgress",created:"numberOfTasksInProgress",failed:"numberOfTasksFailed",completed:"numberOfTasksCompleted"},stats={numberOfTasksFailed:0,numberOfTasksCompleted:0,numberOfTasksInProgress:0};return _.forEach(elements,function(element){var status=element.getStatus();statusMap[status]&&stats[statusMap[status]]++}),getBadgeDataFromStatus(stats)},_alignementConfig={initial:{hPos:"center",hOrigin:"center",vPos:"bottom",vOrigin:"top",hOffset:-156},showDetail:{hPos:"center",hOrigin:"center",vPos:"bottom",vOrigin:"top",hOffset:-277}},taskQueue={getTaskElements:function(){return this.taskElements},showDetail:function(taskData){var $component=this.getElement(),list=this.list,reportElement=reportElementFactory({replace:!0},taskData).on("close",function(){list.hideDetail(),list.alignWith($component,_alignementConfig.initial),this.destroy()});return list.setDetail(reportElement,!0),list.alignWith($component,_alignementConfig.showDetail),this},addNewTask:function(taskData,animate){var self=this,taskId=taskData.id,listElement=listElementFactory({},taskData).on("remove",function(){delete self.taskElements[taskId],self.list.removeElement(listElement),self.trigger("remove",taskId),self.trigger("listchange")}).on("report",function(){self.trigger("report",taskId)}).on("download",function(){self.trigger("download",taskId)}).on("redirect",function(){loadingBar.start(),self.hideList(),self.trigger("redirect",taskId)});return animate&&(this.list.is("hidden")&&this.list.show(),this.list.scrollToTop()),this.list.insertElement(listElement),this.taskElements[taskId]=listElement,this.trigger("listchange"),animate&&this.list.animateInsertion(listElement),this},selfUpdateBadge:function(){var badgeData=getBadgeDataFromElements(this.getTaskElements());return this.badge?this.badge.update(badgeData):this.badge=makePulsable(badgeFactory(badgeData)).render(this.getElement()),this},loadData:function(tasksData){var self=this,found=[];return _.forEach(tasksData,function(entry){var id=entry.id;self.taskElements[id]?(self.taskElements[id].update(entry),self.taskElements[id].getStatus()!==entry.status&&self.taskElements[id].highlight()):self.addNewTask(entry),found.push(id)}),_.forEach(_.difference(_.keys(self.taskElements),found),function(id){self.list.removeElement(self.taskElements[id]),delete self.taskElements[id]}),this.trigger("listchange"),this},pulse:function(){return this.badge&&this.badge.pulse(3),this},showList:function(){return this.list&&(this.list.show(),this.trigger("listshow")),this},hideList:function(){return this.list&&(this.list.hide(),this.trigger("listhide")),this},removeAllFinished:function(){var self=this;return _(this.taskElements).filter(function(element){return"completed"===element.getStatus()||"failed"===element.getStatus()}).forEach(function(element){delete self.taskElements[element.getId()],self.list.removeElement(element),self.trigger("listchange")}),this.trigger("listclearfinished"),this},selfUpdateClearButton:function(){var $clearAllBox=this.getElement().find(".clear-box"),finishedCount=_(this.taskElements).map(function(element){return element.getStatus()}).filter(function(status){return"completed"===status||"failed"===status}).size();return 0<finishedCount?hider.show($clearAllBox):hider.hide($clearAllBox),this}};return function(config,data){return data=data||{},makeAbsorbable(component(taskQueue)).setTemplate(managerTpl).on("destroy listhide",function(){$(document).off("click.task-queue-manager")}).on("init",function(){this.taskElements={},this.list=makeAlignable(taskListFactory()).init({title:__("Background tasks"),emptyText:__("There is currently no background task")})}).on("listshow",function(){var self=this,$component=this.getElement();$(document).off("click.task-queue-manager").on("click.task-queue-manager",function(e){$component.get(0)===e.target||$.contains($component.get(0),e.target)||self.list.is("hidden")||self.hideList()})}).on("listchange",function(){this.selfUpdateBadge(),this.selfUpdateClearButton()}).on("render",function(){var self=this,$trigger=this.getElement();this.list.render($trigger).moveBy(0,0).alignWith($trigger,_alignementConfig.initial).hide(),this.loadData(data),this.list.getElement().addClass("overflown-element").on("click",function(e){e.stopPropagation()}),this.list.on("clearall",function(){self.removeAllFinished()}),$trigger.on("click",function(){self.list.is("hidden")?self.showList():self.hideList()})}).init(config||{})}}),define("util/url",["lodash","context"],function(_,context){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}_=_&&_.hasOwnProperty("default")?_["default"]:_,context=context&&context.hasOwnProperty("default")?context["default"]:context;var parsers={absolute:/^(?:[a-z]+:)?\/\//i,base64:/^data:[^\/]+\/[^;]+(;charset=[\w]+)?;base64,/,query:/(?:^|&)([^&=]*)=?([^&]*)/g,url:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/};return{parse:function(url){var keys=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","queryString","hash"],i=keys.length,parsed=Object.create({toString:function(){return this.source}}),matches;if(parsed.base64=parsers.base64.test(url),parsed.base64)parsed.source=url;else{for(matches=parsers.url.exec(url);i--;)parsed[keys[i]]=matches[i]||"";parsed.query={},parsed.queryString.replace(parsers.query,function($0,$1,$2){$1&&(parsed.query[$1]=$2)})}return parsed},isAbsolute:function(url){return"object"===_typeof(url)&&url.hasOwnProperty("source")?url.source!==url.relative:"string"==typeof url?parsers.absolute.test(url):void 0},isRelative:function(url){var absolute=this.isAbsolute(url);if("boolean"==typeof absolute)return!absolute},isBase64:function(url){return"object"===_typeof(url)&&url.hasOwnProperty("source")?url.base64:"string"==typeof url?parsers.base64.test(url):void 0},encodeAsXmlAttr:function(uri){return /[<>&']+/.test(uri)?encodeURIComponent(uri):uri},build:function(path,params){var queryString="",url,hasQueryString;return path&&(_.isString(path)&&(url=path),_.isArray(path)&&(url="",_.forEach(path,function(chunk){url+=/\/$/.test(url)&&/^\//.test(chunk)?chunk.substr(1):""===url||/\/$/.test(url)||/^\//.test(chunk)?chunk:"/"+chunk})),_.isPlainObject(params)&&(hasQueryString=-1<url.indexOf("?"),queryString=_.reduce(params,function(acc,value,key){return(!_.isEmpty(acc)||hasQueryString)&&(acc+="&"),"object"!==_typeof(value)||_.isArray(value)?acc+=encodeURIComponent(key)+"="+encodeURIComponent(value):_.forOwn(value,function(parameterValue,parameterName){acc+=encodeURIComponent(key)+"["+encodeURIComponent(parameterName)+"]="+encodeURIComponent(parameterValue)+"&"}),acc},queryString),!_.isEmpty(queryString)&&(!hasQueryString&&(url+="?"),url+=queryString))),url},route:function(action,controller,extension,params,rootUrl){var routeParts=[extension,controller,action];if(_.some(routeParts,function(value){return _.isEmpty(value)||!_.isString(value)}))throw new TypeError("All parts are required to build an URL");return rootUrl=rootUrl||context&&context.root_url,this.build([rootUrl].concat(routeParts),params)}}}),define("core/polling",["lodash","core/promise","core/eventifier"],function(_,Promise,eventifier){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier["default"]:eventifier;var pollingFactory=function(config){var _Mathabs=Math.abs,state={},startTimer=function(){timer=setTimeout(iteration,interval),state.stopped=!1,state.pending=!0},stopTimer=function(){clearTimeout(timer),timer=null,state.stopped=!0,state.pending=!1},iteration=function(){return max&&iter>=max?void polling.stop():void(iter=(iter||0)+1,state.processing=!0,state.pending=!1,polling.trigger("call"),action.call(context,polling),!promise&&!state.stopped&&(state.processing=!1,startTimer()))},polling={async:function(){var resolver={};return promise=new Promise(function(resolve,reject){resolver.resolve=resolve,resolver.reject=reject}),promise.then(function(){promise=null,state.processing=!1,state.stopped||startTimer(),polling.trigger("resolved")}).catch(function(){promise=null,state.processing=!1,polling.stop(),polling.trigger("rejected")}),polling.trigger("async",resolver),resolver},next:function(){var _next;return(state.stopped&&(iter=0),stopTimer(),max&&iter>=max)?this:(state.stopped=!1,promise?(_next=this.next.bind(this),promise.then(_next).catch(_next)):(this.trigger("next"),iteration()),this)},start:function(){return timer||(iter=0,startTimer(),this.trigger("start")),this},stop:function(){return stopTimer(),this.trigger("stop"),this},setInterval:function(value){return interval=_Mathabs(parseInt(value,10)||60000),this.trigger("setinterval",interval),this},getInterval:function(){return interval},setAction:function(fn){return action=fn,this.trigger("setaction",action),this},getAction:function(){return action},setContext:function(ctx){return context=ctx||this,this.trigger("setcontext",ctx),this},getContext:function(){return context},setMax:function(value){return max=_Mathabs(parseInt(value,10)||0),this},getMax:function(){return max},getIteration:function(){return iter||0},is:function(stateName){return!!state[stateName]}},timer,promise,interval,max,iter,action,context,autoStart;return eventifier(polling),interval=60000,context=polling,action=null,state.stopped=!0,autoStart=!1,iter=0,_.isFunction(config)&&(polling.setAction(config),config=null),_.isObject(config)&&(polling.setAction(config.action),polling.setInterval(config.interval||arguments[1]),polling.setContext(config.context),polling.setMax(config.max),autoStart=!!config.autoStart),autoStart&&polling.start(),polling};return pollingFactory}),define("core/promiseQueue",["lodash","core/promise","core/eventifier","lib/uuid"],function(_,Promise,eventifier,uuid){'use strict';return _=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier["default"]:eventifier,uuid=uuid&&uuid.hasOwnProperty("default")?uuid["default"]:uuid,function(){var queue={},getId=function getId(){var id="promise-"+uuid(6);return"undefined"==typeof queue[id]?id:getId()};return{add:function(promise){return queue[getId()]=promise,this},getValues:function(){return _.values(queue)},clear:function(){return queue={},this},serie:function(promiseFn){var id=getId(),currentQueue=this.getValues(),emitter=eventifier();return queue[id]=new Promise(function(resolve){emitter.on("fulfilled",resolve)}),Promise.all(currentQueue).then(function(){if(_.isFunction(promiseFn))return promiseFn()}).then(function(data){return emitter.trigger("fulfilled"),delete queue[id],data}).catch(function(err){throw queue={},err})}}}}),define("core/store/localstorage",["lodash","core/promise","core/promiseQueue","lib/uuid"],function(_,Promise,promiseQueue,uuid){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,promiseQueue=promiseQueue&&promiseQueue.hasOwnProperty("default")?promiseQueue["default"]:promiseQueue,uuid=uuid&&uuid.hasOwnProperty("default")?uuid["default"]:uuid;var storage=window.localStorage,knownStoresName="index",idStoreName="id",writingQueue=promiseQueue(),setEntry=function(storeName,key,value){return new Promise(function(resolve,reject){try{storage.setItem("tao-store-"+storeName+"."+key,JSON.stringify(value)),resolve(!0)}catch(ex){reject(ex)}})},getEntry=function(storeName,key){return new Promise(function(resolve,reject){var value;try{value=storage.getItem("tao-store-"+storeName+"."+key),null===value?resolve():resolve(JSON.parse(value))}catch(ex){reject(ex)}})},getKnownStores=function(){return getEntry(knownStoresName,"stores")},registerStore=function(storeName){return getKnownStores().then(function(stores){return stores=stores||{},stores[storeName]={name:storeName,lastOpen:Date.now()},setEntry(knownStoresName,"stores",stores)})},unregisterStore=function(storeName){return getKnownStores().then(function(stores){return stores=stores||{},delete stores[storeName],setEntry(knownStoresName,"stores",stores)})},localStorageBackend=function(storeName){var registered=!1,openStore=function(){return registered?Promise.resolve():registerStore(storeName).then(function(){registered=!0})},name;if(_.isEmpty(storeName)||!_.isString(storeName))throw new TypeError("The store name is required");return name="tao-store-"+storeName+".",{getItem:function(key){return writingQueue.serie(function(){return openStore().then(function(){return getEntry(storeName,key)})})},setItem:function(key,value){return writingQueue.serie(function(){return openStore().then(function(){return setEntry(storeName,key,value)})})},removeItem:function(key){return writingQueue.serie(function(){return openStore().then(function(){return storage.removeItem(name+key),!0})})},getItems:function(){var keyPattern=new RegExp("^"+name);return writingQueue.serie(function(){return openStore().then(function(){return _(storage).map(function(entry,index){return storage.key(index)}).filter(function(key){return keyPattern.test(key)}).reduce(function(acc,key){var exposedKey=key.replace(name,""),value;try{value=storage.getItem(key),null!==value&&(acc[exposedKey]=JSON.parse(value))}catch(ex){acc[exposedKey]=null}return acc},{})})})},clear:function(){var keyPattern=new RegExp("^"+name);return writingQueue.serie(function(){return openStore().then(function(){return _(storage).map(function(entry,index){return storage.key(index)}).filter(function(key){return keyPattern.test(key)}).forEach(function(key){storage.removeItem(key)}),!0})})},removeStore:function(){return this.clear().then(function(){return unregisterStore(storeName)})}}};return localStorageBackend.removeAll=function(validate){return _.isFunction(validate)||(validate=null),getKnownStores().then(function(stores){var removing=_(stores).filter(function(store,storeName){return!validate||validate(storeName,store)}).map(function(store){return store&&store.name?localStorageBackend(store.name).removeStore():Promise.resolve()}).value();return Promise.all(removing)})},localStorageBackend.getAll=function(validate){return getKnownStores().then(function(stores){return _(stores).filter(function(store,storeName){return!validate||validate(storeName,store)}).map(function(store){return store.name}).value()})},localStorageBackend.getStoreIdentifier=function(){var idStore=localStorageBackend(idStoreName);return idStore.getItem(idStoreName).then(function(id){return _.isEmpty(id)?(id=uuid(),idStore.setItem(idStoreName,id).then(function(){return id})):id})},localStorageBackend}),define("core/store/indexeddb",["lodash","core/promise","lib/uuid"],function(_,Promise,uuid){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}_=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,uuid=uuid&&uuid.hasOwnProperty("default")?uuid["default"]:uuid;var commonjsGlobal="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis,idbstore=function(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}(function(module){(function(name,definition,global){module.exports?module.exports=definition():global[name]=definition()})("IDBStore",function(){function mixin(target,source){var name,s;for(name in source)s=source[name],s!==empty[name]&&s!==target[name]&&(target[name]=s);return target}var defaultErrorHandler=function(error){throw error},defaultSuccessHandler=function(){},defaults={storeName:"Store",storePrefix:"IDBWrapper-",dbVersion:1,keyPath:"id",autoIncrement:!0,onStoreReady:function(){},onError:defaultErrorHandler,indexes:[],implementationPreference:["indexedDB","webkitIndexedDB","mozIndexedDB","shimIndexedDB"]},IDBStore=function(kwArgs,onStoreReady){for(var key in"undefined"==typeof onStoreReady&&"function"==typeof kwArgs&&(onStoreReady=kwArgs),"[object Object]"!=Object.prototype.toString.call(kwArgs)&&(kwArgs={}),defaults)this[key]="undefined"==typeof kwArgs[key]?defaults[key]:kwArgs[key];this.dbName=this.storePrefix+this.storeName,this.dbVersion=parseInt(this.dbVersion,10)||1,onStoreReady&&(this.onStoreReady=onStoreReady);var env="object"==("undefined"==typeof window?"undefined":_typeof(window))?window:self,availableImplementations=this.implementationPreference.filter(function(implName){return implName in env});this.implementation=availableImplementations[0],this.idb=env[this.implementation],this.keyRange=env.IDBKeyRange||env.webkitIDBKeyRange||env.mozIDBKeyRange,this.consts={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange",NEXT:"next",NEXT_NO_DUPLICATE:"nextunique",PREV:"prev",PREV_NO_DUPLICATE:"prevunique"},this.openDB()},proto={constructor:IDBStore,version:"1.7.0",db:null,dbName:null,dbVersion:null,store:null,storeName:null,storePrefix:null,keyPath:null,autoIncrement:null,indexes:null,implementationPreference:null,implementation:"",onStoreReady:null,onError:null,_insertIdCount:0,openDB:function(){var openRequest=this.idb.open(this.dbName,this.dbVersion),preventSuccessCallback=!1;openRequest.onerror=function(error){var gotVersionErr=!1;"error"in error.target?gotVersionErr="VersionError"==error.target.error.name:"errorCode"in error.target&&(gotVersionErr=12==error.target.errorCode),gotVersionErr?this.onError(new Error("The version number provided is lower than the existing one.")):this.onError(error)}.bind(this),openRequest.onsuccess=function(event){if(!preventSuccessCallback){if(this.db)return void this.onStoreReady();if(this.db=event.target.result,"string"==typeof this.db.version)return void this.onError(new Error("The IndexedDB implementation in this browser is outdated. Please upgrade your browser."));if(!this.db.objectStoreNames.contains(this.storeName))return void this.onError(new Error("Object store couldn't be created."));var emptyTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY);this.store=emptyTransaction.objectStore(this.storeName);var existingIndexes=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(indexData){var indexName=indexData.name;if(!indexName)return preventSuccessCallback=!0,void this.onError(new Error("Cannot create index: No index name given."));if(this.normalizeIndexData(indexData),this.hasIndex(indexName)){var actualIndex=this.store.index(indexName),complies=this.indexComplies(actualIndex,indexData);complies||(preventSuccessCallback=!0,this.onError(new Error("Cannot modify index \""+indexName+"\" for current version. Please bump version number to "+(this.dbVersion+1)+"."))),existingIndexes.splice(existingIndexes.indexOf(indexName),1)}else preventSuccessCallback=!0,this.onError(new Error("Cannot create new index \""+indexName+"\" for current version. Please bump version number to "+(this.dbVersion+1)+"."))},this),existingIndexes.length&&(preventSuccessCallback=!0,this.onError(new Error("Cannot delete index(es) \""+existingIndexes.toString()+"\" for current version. Please bump version number to "+(this.dbVersion+1)+"."))),preventSuccessCallback||this.onStoreReady()}}.bind(this),openRequest.onupgradeneeded=function(event){if(this.db=event.target.result,this.db.objectStoreNames.contains(this.storeName))this.store=event.target.transaction.objectStore(this.storeName);else{var optionalParameters={autoIncrement:this.autoIncrement};null!==this.keyPath&&(optionalParameters.keyPath=this.keyPath),this.store=this.db.createObjectStore(this.storeName,optionalParameters)}var existingIndexes=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(indexData){var indexName=indexData.name;if(indexName||(preventSuccessCallback=!0,this.onError(new Error("Cannot create index: No index name given."))),this.normalizeIndexData(indexData),this.hasIndex(indexName)){var actualIndex=this.store.index(indexName),complies=this.indexComplies(actualIndex,indexData);complies||(this.store.deleteIndex(indexName),this.store.createIndex(indexName,indexData.keyPath,{unique:indexData.unique,multiEntry:indexData.multiEntry})),existingIndexes.splice(existingIndexes.indexOf(indexName),1)}else this.store.createIndex(indexName,indexData.keyPath,{unique:indexData.unique,multiEntry:indexData.multiEntry})},this),existingIndexes.length&&existingIndexes.forEach(function(_indexName){this.store.deleteIndex(_indexName)},this)}.bind(this)},deleteDatabase:function(onSuccess,onError){if(this.idb.deleteDatabase){this.db.close();var deleteRequest=this.idb.deleteDatabase(this.dbName);deleteRequest.onsuccess=onSuccess,deleteRequest.onerror=onError}else onError(new Error("Browser does not support IndexedDB deleteDatabase!"))},put:function(key,value,onSuccess,onError){null!==this.keyPath&&(onError=onSuccess,onSuccess=value,value=key),onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler);var hasSuccess=!1,result=null,putTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE),putRequest;return putTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},putTransaction.onabort=onError,putTransaction.onerror=onError,null===this.keyPath?putRequest=putTransaction.objectStore(this.storeName).put(value,key):(this._addIdPropertyIfNeeded(value),putRequest=putTransaction.objectStore(this.storeName).put(value)),putRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},putRequest.onerror=onError,putTransaction},get:function(key,onSuccess,onError){onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler);var hasSuccess=!1,result=null,getTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY);getTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},getTransaction.onabort=onError,getTransaction.onerror=onError;var getRequest=getTransaction.objectStore(this.storeName).get(key);return getRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},getRequest.onerror=onError,getTransaction},remove:function(key,onSuccess,onError){onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler);var hasSuccess=!1,result=null,removeTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);removeTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},removeTransaction.onabort=onError,removeTransaction.onerror=onError;var deleteRequest=removeTransaction.objectStore(this.storeName)["delete"](key);return deleteRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},deleteRequest.onerror=onError,removeTransaction},batch:function(dataArray,onSuccess,onError){if(onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler),"[object Array]"!=Object.prototype.toString.call(dataArray))onError(new Error("dataArray argument must be of type Array."));else if(0===dataArray.length)return onSuccess(!0);var count=dataArray.length,called=!1,hasSuccess=!1,batchTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);batchTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(hasSuccess)},batchTransaction.onabort=onError,batchTransaction.onerror=onError;var onItemSuccess=function(){count--,0!==count||called||(called=!0,hasSuccess=!0)};return dataArray.forEach(function(operation){var type=operation.type,key=operation.key,value=operation.value,onItemError=function(err){batchTransaction.abort(),called||(called=!0,onError(err,type,key))};if("remove"==type){var deleteRequest=batchTransaction.objectStore(this.storeName)["delete"](key);deleteRequest.onsuccess=onItemSuccess,deleteRequest.onerror=onItemError}else if("put"==type){var putRequest;null===this.keyPath?putRequest=batchTransaction.objectStore(this.storeName).put(value,key):(this._addIdPropertyIfNeeded(value),putRequest=batchTransaction.objectStore(this.storeName).put(value)),putRequest.onsuccess=onItemSuccess,putRequest.onerror=onItemError}},this),batchTransaction},putBatch:function(dataArray,onSuccess,onError){var batchData=dataArray.map(function(item){return{type:"put",value:item}});return this.batch(batchData,onSuccess,onError)},upsertBatch:function(dataArray,options,onSuccess,onError){"function"==typeof options&&(onSuccess=options,onError=onSuccess,options={}),onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler),options||(options={}),"[object Array]"!=Object.prototype.toString.call(dataArray)&&onError(new Error("dataArray argument must be of type Array."));var keyField=options.keyField||this.keyPath,count=dataArray.length,called=!1,hasSuccess=!1,index=0,batchTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);batchTransaction.oncomplete=function(){hasSuccess?onSuccess(dataArray):onError(!1)},batchTransaction.onabort=onError,batchTransaction.onerror=onError;var onItemSuccess=function(event){var record=dataArray[index++];record[keyField]=event.target.result,count--,0!==count||called||(called=!0,hasSuccess=!0)};return dataArray.forEach(function(record){var key=record.key,onItemError=function(err){batchTransaction.abort(),called||(called=!0,onError(err))},putRequest;null===this.keyPath?putRequest=batchTransaction.objectStore(this.storeName).put(record,key):(this._addIdPropertyIfNeeded(record),putRequest=batchTransaction.objectStore(this.storeName).put(record)),putRequest.onsuccess=onItemSuccess,putRequest.onerror=onItemError},this),batchTransaction},removeBatch:function(keyArray,onSuccess,onError){var batchData=keyArray.map(function(key){return{type:"remove",key:key}});return this.batch(batchData,onSuccess,onError)},getBatch:function(keyArray,onSuccess,onError,arrayType){if(onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler),arrayType||(arrayType="sparse"),"[object Array]"!=Object.prototype.toString.call(keyArray))onError(new Error("keyArray argument must be of type Array."));else if(0===keyArray.length)return onSuccess([]);var data=[],count=keyArray.length,hasSuccess=!1,result=null,batchTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY);batchTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},batchTransaction.onabort=onError,batchTransaction.onerror=onError;var onItemSuccess=function(event){event.target.result||"dense"==arrayType?data.push(event.target.result):"sparse"==arrayType&&data.length++,count--,0===count&&(hasSuccess=!0,result=data)};return keyArray.forEach(function(key){var onItemError=function(err){result=err,onError(err),batchTransaction.abort()},getRequest=batchTransaction.objectStore(this.storeName).get(key);getRequest.onsuccess=onItemSuccess,getRequest.onerror=onItemError},this),batchTransaction},getAll:function(onSuccess,onError){onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler);var getAllTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY),store=getAllTransaction.objectStore(this.storeName);return store.getAll?this._getAllNative(getAllTransaction,store,onSuccess,onError):this._getAllCursor(getAllTransaction,store,onSuccess,onError),getAllTransaction},_getAllNative:function(getAllTransaction,store,onSuccess,onError){var hasSuccess=!1,result=null;getAllTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},getAllTransaction.onabort=onError,getAllTransaction.onerror=onError;var getAllRequest=store.getAll();getAllRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},getAllRequest.onerror=onError},_getAllCursor:function(getAllTransaction,store,onSuccess,onError){var all=[],hasSuccess=!1,result=null;getAllTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},getAllTransaction.onabort=onError,getAllTransaction.onerror=onError;var cursorRequest=store.openCursor();cursorRequest.onsuccess=function(event){var cursor=event.target.result;cursor?(all.push(cursor.value),cursor["continue"]()):(hasSuccess=!0,result=all)},cursorRequest.onError=onError},clear:function(onSuccess,onError){onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler);var hasSuccess=!1,result=null,clearTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);clearTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},clearTransaction.onabort=onError,clearTransaction.onerror=onError;var clearRequest=clearTransaction.objectStore(this.storeName).clear();return clearRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},clearRequest.onerror=onError,clearTransaction},_addIdPropertyIfNeeded:function(dataObj){"undefined"==typeof dataObj[this.keyPath]&&(dataObj[this.keyPath]=this._insertIdCount++ +Date.now())},getIndexList:function(){return this.store.indexNames},hasIndex:function(indexName){return this.store.indexNames.contains(indexName)},normalizeIndexData:function(indexData){indexData.keyPath=indexData.keyPath||indexData.name,indexData.unique=!!indexData.unique,indexData.multiEntry=!!indexData.multiEntry},indexComplies:function(actual,expected){var complies=["keyPath","unique","multiEntry"].every(function(key){if("multiEntry"==key&&void 0===actual[key]&&!1===expected[key])return!0;if("keyPath"==key&&"[object Array]"==Object.prototype.toString.call(expected[key])){var exp=expected.keyPath,act=actual.keyPath;if("string"==typeof act)return exp.toString()==act;if("function"!=typeof act.contains&&"function"!=typeof act.indexOf)return!1;if(act.length!==exp.length)return!1;for(var i=0,m=exp.length;i<m;i++)if(!(act.contains&&act.contains(exp[i])||act.indexOf(-1!==exp[i])))return!1;return!0}return expected[key]==actual[key]});return complies},iterate:function(onItem,options){options=mixin({index:null,order:"ASC",autoContinue:!0,filterDuplicates:!1,keyRange:null,writeAccess:!1,onEnd:null,onError:defaultErrorHandler,limit:1/0,offset:0,allowItemRejection:!1},options||{});var directionType="desc"==options.order.toLowerCase()?"PREV":"NEXT";options.filterDuplicates&&(directionType+="_NO_DUPLICATE");var hasSuccess=!1,cursorTransaction=this.db.transaction([this.storeName],this.consts[options.writeAccess?"READ_WRITE":"READ_ONLY"]),cursorTarget=cursorTransaction.objectStore(this.storeName);options.index&&(cursorTarget=cursorTarget.index(options.index));var recordCount=0;cursorTransaction.oncomplete=function(){return hasSuccess?void(options.onEnd?options.onEnd():onItem(null)):void options.onError(null)},cursorTransaction.onabort=options.onError,cursorTransaction.onerror=options.onError;var cursorRequest=cursorTarget.openCursor(options.keyRange,this.consts[directionType]);return cursorRequest.onerror=options.onError,cursorRequest.onsuccess=function(event){var cursor=event.target.result;if(!cursor)hasSuccess=!0;else if(options.offset)cursor.advance(options.offset),options.offset=0;else{var onItemReturn=onItem(cursor.value,cursor,cursorTransaction);options.allowItemRejection&&!1===onItemReturn||recordCount++,options.autoContinue&&(recordCount+options.offset<options.limit?cursor["continue"]():hasSuccess=!0)}},cursorTransaction},query:function(onSuccess,options){var result=[],processedItems=0;return options=options||{},options.autoContinue=!0,options.writeAccess=!1,options.allowItemRejection=!!options.filter,options.onEnd=function(){onSuccess(result,processedItems)},this.iterate(function(item){processedItems++;var accept=!options.filter||options.filter(item);return!1!==accept&&result.push(item),accept},options)},count:function(onSuccess,options){options=mixin({index:null,keyRange:null},options||{});var onError=options.onError||defaultErrorHandler,hasSuccess=!1,result=null,cursorTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY);cursorTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},cursorTransaction.onabort=onError,cursorTransaction.onerror=onError;var cursorTarget=cursorTransaction.objectStore(this.storeName);options.index&&(cursorTarget=cursorTarget.index(options.index));var countRequest=cursorTarget.count(options.keyRange);return countRequest.onsuccess=function(evt){hasSuccess=!0,result=evt.target.result},countRequest.onError=onError,cursorTransaction},makeKeyRange:function(options){var hasLower="undefined"!=typeof options.lower,hasUpper="undefined"!=typeof options.upper,isOnly="undefined"!=typeof options.only,keyRange;switch(!0){case isOnly:keyRange=this.keyRange.only(options.only);break;case hasLower&&hasUpper:keyRange=this.keyRange.bound(options.lower,options.upper,options.excludeLower,options.excludeUpper);break;case hasLower:keyRange=this.keyRange.lowerBound(options.lower,options.excludeLower);break;case hasUpper:keyRange=this.keyRange.upperBound(options.upper,options.excludeUpper);break;default:throw new Error("Cannot create KeyRange. Provide one or both of \"lower\" or \"upper\" value, or an \"only\" value.");}return keyRange}},empty={};return IDBStore.prototype=proto,IDBStore.version=proto.version,IDBStore},commonjsGlobal)}),idStoreName="id",isIndexedDB2="undefined"!=typeof IDBObjectStore&&"getAll"in IDBObjectStore.prototype,openStore=function(storeName){return new Promise(function(resolve,reject){var store=new idbstore({dbVersion:1,storeName:storeName,storePrefix:"tao-store-",keyPath:"key",autoIncrement:!0,onStoreReady:function(){store.db.onversionchange=function(e){e&&e.newVersion||store.db.close()},resolve(store)},onError:reject})})},setEntry=function(store,key,value){return new Promise(function(resolve,reject){store.put({key:key,value:value},function(returnKey){resolve(returnKey===key)},reject)})},getEntry=function(store,key){return new Promise(function(resolve,reject){store.get(key,function(entry){return entry&&"undefined"!=typeof entry.value?void resolve(entry.value):resolve(entry)},reject)})},getEntries=function(store){return new Promise(function(resolve,reject){var success=function(entries){return _.isArray(entries)?void resolve(_.reduce(entries,function(acc,entry){return entry.key&&entry.value&&(acc[entry.key]=entry.value),acc},{})):resolve({})};store.getAll(success,reject)})},removeEntry=function(store,key){return new Promise(function(resolve,reject){store.remove(key,function(result){resolve(!1!==result)},reject)})},getKnownStores=function(){return knownStores||(knownStores=openStore("index")),knownStores},registerStore=function(storeName){return getKnownStores().then(function(store){return setEntry(store,storeName,{name:storeName,lastOpen:Date.now()})})},unregisterStore=function(storeName){return getKnownStores().then(function(store){return removeEntry(store,storeName)})},deleteStore=function(store,storeName){return new Promise(function(resolve,reject){var success=function(){unregisterStore(storeName).then(function(){resolve(!0)}).catch(reject)};isIndexedDB2?store.deleteDatabase(success,reject):store.clear(success,reject)})},indexDbBackend=function(storeName){var getStore=function(){return innerStore||(innerStore=openStore(storeName).then(function(store){return registerStore(storeName).then(function(){return Promise.resolve(store)})})),innerStore},ensureSerie=function(getWritingPromise){return writePromise?new Promise(function(resolve,reject){var runWrite=function(){var p=getWritingPromise();writePromise=p,p.then(resolve).catch(reject)};writePromise.then(runWrite).catch(runWrite)}):(writePromise=getWritingPromise(),writePromise)},innerStore,writePromise;if(_.isEmpty(storeName)||!_.isString(storeName))throw new TypeError("The store name is required");return{getItem:function(key){return ensureSerie(function(){return getStore().then(function(store){return getEntry(store,key)})})},setItem:function(key,value){return ensureSerie(function(){return getStore().then(function(store){return setEntry(store,key,value)})})},removeItem:function(key){return ensureSerie(function(){return getStore().then(function(store){return removeEntry(store,key)})})},getItems:function(){return ensureSerie(function(){return getStore().then(function(store){return getEntries(store)})})},clear:function(){return ensureSerie(function(){return getStore().then(function(store){return new Promise(function(resolve,reject){store.clear(function(){resolve(!0)},reject)})})})},removeStore:function(){return ensureSerie(function(){return getStore().then(function(store){return deleteStore(store,storeName)})})}}},knownStores;return indexDbBackend.removeAll=function(validate){return _.isFunction(validate)||(validate=null),getKnownStores().then(function(store){return new Promise(function(resolve,reject){function cleanUp(entries){var all=[];_.forEach(entries,function(entry){var storeName=entry&&entry.key;storeName&&all.push(openStore(storeName).then(function(storeToRemove){if(!validate||validate(storeName,entry.value))return deleteStore(storeToRemove,storeName)}))}),Promise.all(all).then(resolve).catch(reject)}store.getAll(cleanUp,reject)})})},indexDbBackend.getAll=function(validate){return _.isFunction(validate)||(validate=function(){return!0}),getKnownStores().then(function(store){return new Promise(function(resolve,reject){store.getAll(function(entries){var storeNames=_(entries).filter(function(entry){return entry&&entry.key&&validate(entry.key,entry.value)}).map(function(entry){return entry.key}).value();return resolve(storeNames)},reject)})})},indexDbBackend.getStoreIdentifier=function(){return openStore(idStoreName).then(function(store){return getEntry(store,idStoreName).then(function(id){return _.isEmpty(id)?(id=uuid(),setEntry(store,idStoreName,id).then(function(){return id})):id})})},indexDbBackend}),define("core/store/memory",["lodash","core/promise","lib/uuid"],function(_,Promise,uuid){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,uuid=uuid&&uuid.hasOwnProperty("default")?uuid["default"]:uuid;var memoryStore={},memoryStorageBackend=function(storeName){if(_.isEmpty(storeName)||!_.isString(storeName))throw new TypeError("The store name is required");return memoryStore[storeName]=memoryStore[storeName]||{},{getItem:function(key){return _.isPlainObject(memoryStore[storeName])?Promise.resolve(memoryStore[storeName][key]):Promise.resolve()},setItem:function(key,value){return _.isPlainObject(memoryStore[storeName])||(memoryStore[storeName]={}),memoryStore[storeName][key]=value,Promise.resolve(!0)},removeItem:function(key){return memoryStore[storeName]=_.omit(memoryStore[storeName],key),Promise.resolve("undefined"==typeof memoryStore[storeName][key])},getItems:function(){return Promise.resolve(memoryStore[storeName])},clear:function(){return memoryStore[storeName]={},Promise.resolve(!0)},removeStore:function(){return memoryStore=_.omit(memoryStore,storeName),Promise.resolve("undefined"==typeof memoryStore[storeName])}}},idStore;return memoryStorageBackend.removeAll=function(validate){return _.isFunction(validate)||(validate=null),memoryStore=_.omit(memoryStore,function(store,storeName){return!validate||validate(storeName)}),Promise.resolve(!0)},memoryStorageBackend.getAll=function(validate){var storeNames=[];return _.isFunction(validate)||(validate=null),storeNames=_(memoryStore).map(function(store,storeName){return storeName}).filter(function(storeName){return!validate||validate(storeName)}).value(),Promise.resolve(storeNames)},memoryStorageBackend.getStoreIdentifier=function(){return _.isEmpty(idStore)&&(idStore=uuid()),Promise.resolve(idStore)},memoryStorageBackend}),define("core/store",["lodash","moment","module","core/logger","core/promise","core/store/localstorage","core/store/indexeddb","core/store/memory"],function(_,moment,module,loggerFactory,Promise,localStorageBackend,indexedDBBackend,memoryBackend){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_,moment=moment&&moment.hasOwnProperty("default")?moment["default"]:moment,module=module&&module.hasOwnProperty("default")?module["default"]:module,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory["default"]:loggerFactory,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,localStorageBackend=localStorageBackend&&localStorageBackend.hasOwnProperty("default")?localStorageBackend["default"]:localStorageBackend,indexedDBBackend=indexedDBBackend&&indexedDBBackend.hasOwnProperty("default")?indexedDBBackend["default"]:indexedDBBackend,memoryBackend=memoryBackend&&memoryBackend.hasOwnProperty("default")?memoryBackend["default"]:memoryBackend;var supportsIndexedDB=!1,dectectionDone=!1,quotaChecked=!1,backendApi=["removeAll","getAll","getStoreIdentifier"],storeApi=["getItem","setItem","removeItem","getItems","clear","removeStore"],logger=loggerFactory("core/store"),config=_.defaults(module.config()||{},{lowSpaceRatio:80,invalidation:{staled:"P2W",oldster:"P2M"}}),isIndexDBSupported=function(){return dectectionDone?Promise.resolve(supportsIndexedDB):new Promise(function(resolve){var done=function(result){return supportsIndexedDB=!!result,dectectionDone=!0,resolve(supportsIndexedDB)},test,indexedDB;try{if(indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB,!indexedDB)return done(!1);test=indexedDB.open("__feature_test",1),test.onsuccess=function(){if(test.result)return test.result.close(),done(!0)},test.onerror=function(e){return e.preventDefault(),done(!1),!1}}catch(err){done(!1)}})},checkQuotas=function(){!quotaChecked&&"storage"in window.navigator&&window.navigator.storage.estimate&&window.navigator.storage.estimate().then(function(estimate){var usedRatio=0;_.isNumber(estimate.usage)&&_.isNumber(estimate.quota)&&0<estimate.quota&&(usedRatio=estimate.usage/estimate.quota,usedRatio>config.lowSpaceRatio?(logger.warn("The browser storage is getting low "+usedRatio.toFixed(2)+"% used",estimate),logger.warn("We will attempt to clean oldster databases in persistent backends"),store.cleanUpSpace(config.invalidation.oldster,[],localStorageBackend),isIndexDBSupported&&store.cleanUpSpace(config.invalidation.oldster,[],indexedDBBackend)):logger.debug("Browser storage estimate : "+usedRatio.toFixed(2)+"% used",estimate))}).catch(function(err){logger.warn("Unable to retrieve quotas : "+err.message)}),quotaChecked=!0},isBackendApiValid=function(backend){return _.all(backendApi,function(method){return _.isFunction(backend[method])})},isStorageApiValid=function(storage){return _.all(storeApi,function(method){return _.isFunction(storage[method])})},loadBackend=function(preselectedBackend){return isIndexDBSupported().then(function(){var backend=preselectedBackend||(supportsIndexedDB?indexedDBBackend:localStorageBackend);return _.isFunction(backend)?isBackendApiValid(backend)?(backend!==memoryBackend&&checkQuotas(),backend):Promise.reject(new TypeError("This backend doesn't comply with the store backend API")):Promise.reject(new TypeError("No backend, no storage!"))})},store;store=function(storeName,preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){var storeInstance=backend(storeName);return isStorageApiValid(storeInstance)?storeInstance:Promise.reject(new TypeError("The store doesn't comply with the Storage interface"))})},store.backends={localStorage:localStorageBackend,indexedDB:indexedDBBackend,memory:memoryBackend},store.removeAll=function(validate,preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){return backend.removeAll(validate)})},store.cleanUpSpace=function(since,storeNamePattern,preselectedBackend){var invalidate=function(storeName,storeEntry){return!!(storeName&&storeEntry)&&(!(storeNamePattern instanceof RegExp)||storeNamePattern.test(storeName))&&_.isNumber(storeEntry.lastOpen)&&_.isNumber(tsThreshold)&&storeEntry.lastOpen<=tsThreshold},tsThreshold;return _.isNumber(since)&&0<since?tsThreshold=since:(!_.isString(since)&&(since=config.invalidation.oldster),tsThreshold=moment().subtract(moment.duration(since)).valueOf()),logger.info("Trying to remove stores lastly opened before "+tsThreshold+"("+since+")"),store.removeAll(invalidate,preselectedBackend)},store.getAll=function(validate,preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){return backend.getAll(validate)})},store.getIdentifier=function(preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){return backend.getStoreIdentifier()})};var store$1=store;return store$1}),define("core/tokenStore",["lodash","core/promise","core/store"],function(_,Promise,store){'use strict';function tokenStoreFactory(options){var config=_.defaults(options||{},defaultConfig),getStore=function(){return store("tokenStore.tokens",store.backends.memory)};return{dequeue:function(){var self=this;return self.getIndex().then(function(latestIndex){var key=_.first(latestIndex);return key?getStore().then(function(storage){return storage.getItem(key)}).then(function(token){return self.remove(key).then(function(){return token})}):Promise.resolve()})},enqueue:function(token){var self=this;return _.isString(token)&&(token={value:token,receivedAt:Date.now()}),getStore().then(function(storage){return storage.setItem(token.value,token)}).then(function(updated){return!!updated&&self.enforceMaxSize().then(function(){return!0})})},getIndex:function(){return this.getTokens().then(function(tokens){return _.chain(tokens).values().sort(function(t1,t2){return t1.receivedAt-t2.receivedAt}).map("value").value()})},has:function(key){return this.getIndex().then(function(latestIndex){return _.contains(latestIndex,key)})},remove:function(key){return this.has(key).then(function(result){return!!result&&getStore().then(function(storage){return storage.removeItem(key)})})},clear:function(){return getStore().then(function(storage){return storage.clear()})},getTokens:function(){return getStore().then(function(storage){return storage.getItems()})},getSize:function(){return this.getIndex().then(function(latestIndex){return latestIndex.length})},setMaxSize:function(size){var self=this;_.isNumber(size)&&0<size&&size!==config.maxSize&&(config.maxSize=size,self.enforceMaxSize())},enforceMaxSize:function(){var self=this;return this.getIndex().then(function(latestIndex){var excess=latestIndex.length-config.maxSize,keysToRemove;return!(0<excess)||(keysToRemove=latestIndex.slice(0,excess),Promise.all(_.map(keysToRemove,function(key){return self.remove(key)})))})},checkExpiry:function(token){return!(Date.now()-token.receivedAt>config.tokenTimeLimit)||this.remove(token.value)},expireOldTokens:function(){var self=this;return self.getTokens().then(function(tokens){return _.reduce(tokens,function(previousPromise,nextToken){return previousPromise.then(function(){return self.checkExpiry(nextToken)})},Promise.resolve()).then(function(){return!0})})}}}_=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,store=store&&store.hasOwnProperty("default")?store["default"]:store;var defaultConfig={maxSize:6,tokenTimeLimit:1440000};return tokenStoreFactory}),define("core/tokenHandler",["lodash","module","core/tokenStore","core/promise","core/promiseQueue"],function(_,module,tokenStoreFactory,Promise,promiseQueue){'use strict';function tokenHandlerFactory(options){var tokenStore;return _.isString(options)&&(options={initialToken:options}),options=_.defaults({},options,defaults),tokenStore=tokenStoreFactory(options),{getToken:function(){var self=this,initialToken=options.initialToken,getFirstTokenValue=function(){return tokenStore.dequeue().then(function(currentToken){return currentToken?currentToken.value:null})};return initialToken?(options.initialToken=null,Promise.resolve(initialToken)):tokenStore.expireOldTokens().then(function(){return tokenStore.getSize()}).then(function(queueSize){return 0<queueSize?getFirstTokenValue():clientConfigFetched?Promise.reject(new Error("No tokens available. Please refresh the page.")):self.getClientConfigTokens().then(getFirstTokenValue)})},setToken:function(newToken){return tokenStore.enqueue(newToken)},getClientConfigTokens:function(){var self=this,clientTokens=_.map(module.config().tokens,function(serverToken){return{value:serverToken,receivedAt:Date.now()}});return clientConfigFetched=!0,Promise.resolve(clientTokens).then(function(newTokens){var setTokenQueue=promiseQueue();return _.forEach(newTokens,function(token){setTokenQueue.serie(function(){return self.setToken(token)})}),setTokenQueue.serie(function(){return!0})})},clearStore:function(){return tokenStore.clear()},getQueueLength:function(){return tokenStore.getSize()},setMaxSize:function(size){tokenStore.setMaxSize(size)}}}_=_&&_.hasOwnProperty("default")?_["default"]:_,module=module&&module.hasOwnProperty("default")?module["default"]:module,tokenStoreFactory=tokenStoreFactory&&tokenStoreFactory.hasOwnProperty("default")?tokenStoreFactory["default"]:tokenStoreFactory,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,promiseQueue=promiseQueue&&promiseQueue.hasOwnProperty("default")?promiseQueue["default"]:promiseQueue;var clientConfigFetched=!1,defaults={maxSize:6,tokenTimeLimit:1440000};return tokenHandlerFactory}),define("core/request",["jquery","lodash","i18n","module","context","core/promise","core/promiseQueue","core/tokenHandler","core/logger"],function($,_,__,module,context,Promise,promiseQueue,tokenHandlerFactory,loggerFactory){'use strict';function request(options){function runRequest(){var computeHeaders=function(){var headers=_.extend({},options.headers);return options.noToken?Promise.resolve(headers):tokenHandler.getToken().then(function(token){return headers["X-CSRF-Token"]=token||"none",headers})},setTokenFromXhr=function(xhr){var token;return _.isFunction(xhr.getResponseHeader)&&(token=xhr.getResponseHeader("X-CSRF-Token"),logger.debug("received %s header %s","X-CSRF-Token",token),token)?tokenHandler.setToken(token):Promise.resolve()};return computeHeaders().then(function(customHeaders){return new Promise(function(resolve,reject){var noop;$.ajax({url:options.url,method:options.method||"GET",headers:customHeaders,data:options.data,contentType:options.contentType||noop,dataType:options.dataType||"json",async:!0,timeout:1e3*options.timeout||1e3*context.timeout||0,beforeSend:function(){_.isEmpty(customHeaders)||logger.debug("sending %s header %s","X-CSRF-Token",customHeaders&&customHeaders["X-CSRF-Token"])},global:!options.background}).done(function(response,status,xhr){setTokenFromXhr(xhr).then(function(){return 204===xhr.status||response&&204===response.errorCode||"nocontent"===status?resolve():403===xhr.status||response&&403===response.errorCode?reject(createError(response,xhr.status+" : "+xhr.statusText,xhr.status,0<xhr.readyState)):200===xhr.status||response&&!0===response.success?resolve(response):void reject(createError(response,__("The server has sent an empty response"),xhr.status,0<xhr.readyState))}).catch(function(error){logger.error(error),reject(createError(response,error,xhr.status,0<xhr.readyState))})}).fail(function(xhr,textStatus,errorThrown){var response;try{response=JSON.parse(xhr.responseText)}catch(parseErr){response={}}response=_.defaults(response,{success:!1,source:"network",cause:options.url,purpose:"proxy",context:this,code:xhr.status,sent:0<xhr.readyState,type:"error",message:errorThrown||__("An error occurred!")}),setTokenFromXhr(xhr).then(function(){reject(createError(response,xhr.status+" : "+xhr.statusText,xhr.status,0<xhr.readyState))}).catch(function(error){logger.error(error),reject(createError(response,error,xhr.status,0<xhr.readyState))})})})})}if(module.config().noToken&&(options.noToken=!0),_.isEmpty(options.url))throw new TypeError("At least give a URL...");return tokenHandler.getQueueLength().then(function(queueLength){return!0===options.noToken?runRequest():options.sequential||1===queueLength?queue.serie(runRequest):runRequest()})}$=$&&$.hasOwnProperty("default")?$["default"]:$,_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,module=module&&module.hasOwnProperty("default")?module["default"]:module,context=context&&context.hasOwnProperty("default")?context["default"]:context,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,promiseQueue=promiseQueue&&promiseQueue.hasOwnProperty("default")?promiseQueue["default"]:promiseQueue,tokenHandlerFactory=tokenHandlerFactory&&tokenHandlerFactory.hasOwnProperty("default")?tokenHandlerFactory["default"]:tokenHandlerFactory,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory["default"]:loggerFactory;var tokenHandler=tokenHandlerFactory(),queue=promiseQueue(),logger=loggerFactory("core/request"),createError=function(response,fallbackMessage,httpCode,httpSent){var err;return err=response&&response.errorCode?new Error(response.errorCode+" : "+(response.errorMsg||response.errorMessage||response.error)):new Error(fallbackMessage),err.response=response,err.sent=httpSent,err.source=response.source||"request",_.isNumber(httpCode)&&(err.code=httpCode),err};return request}),define("core/dataProvider/request",["lodash","core/request"],function(_,coreRequest){'use strict';function request(url,data,method,headers,background,noToken){return coreRequest({url:url,data:data,method:method,headers:headers,background:background,noToken:!1!==noToken}).then(function(response){return _.isUndefined(response)?Promise.resolve():response.success?Promise.resolve(response.data):Promise.reject(response)}).catch(function(error){return Promise.reject(error)})}return _=_&&_.hasOwnProperty("default")?_["default"]:_,coreRequest=coreRequest&&coreRequest.hasOwnProperty("default")?coreRequest["default"]:coreRequest,request}),define("util/regexEscape",[],function(){'use strict';return function(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}}),define("util/wrapLongWords",["util/regexEscape"],function(regexEscape){'use strict';function wrapLongWords(str,threshold){str=str.toString().replace(/([\w])</g,"$1 <");for(var chunkExp=new RegExp(".{1,"+threshold+"}","g"),longWords=str.match(new RegExp("[\\S]{"+threshold+",}","g"))||[],i=longWords.length,cut;i--;)cut=getCutTerm(longWords[i],chunkExp),str=str.replace(new RegExp(regexEscape(longWords[i]),"g"),cut);return str}regexEscape=regexEscape&&regexEscape.hasOwnProperty("default")?regexEscape["default"]:regexEscape;var getCutTerm=function(longWord,chunkExp){for(var cutTerms=longWord.match(chunkExp),i=cutTerms.length,oldFirst="",newFirst="",offenders=[".",":",";"];i--;)newFirst=cutTerms[i].charAt(0),-1<offenders.indexOf(newFirst)&&(cutTerms[i]=cutTerms[i].substr(1)),-1<offenders.indexOf(oldFirst)&&(cutTerms[i]+=oldFirst),oldFirst=newFirst;return cutTerms.join(" ")};return wrapLongWords}),define("util/encode",[],function(){'use strict';var _reQuot=/"/g,_reApos=/'/g,encodeHTML=function(html){return document.createElement("a").appendChild(document.createTextNode(html)).parentNode.innerHTML};return{html:encodeHTML,attribute:function(html){return encodeHTML(html).replace(_reQuot,"&quot;").replace(_reApos,"&apos;")},encodeBase64:function(str){return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,function(match,p1){return String.fromCharCode("0x"+p1)}))},decodeBase64:function(str){return decodeURIComponent(Array.prototype.map.call(atob(str),function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join(""))}}}),define("ui/feedback",["jquery","lodash","core/format","ui/component","util/wrapLongWords","util/encode","handlebars","i18n","lib/dompurify/purify"],function($$1,_,format,component,wrapLongWords,encode,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function tpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,format=format&&format.hasOwnProperty("default")?format["default"]:format,component=component&&component.hasOwnProperty("default")?component["default"]:component,wrapLongWords=wrapLongWords&&wrapLongWords.hasOwnProperty("default")?wrapLongWords["default"]:wrapLongWords,encode=encode&&encode.hasOwnProperty("default")?encode["default"]:encode,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing,stack1,helper,options;return buffer+="<div id=\"",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" class=\"feedback feedback-",(helper=helpers.level)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.level,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+" ",stack1=helpers["if"].call(depth0,depth0&&depth0.popup,{hash:{},inverse:self.noop,fn:self.program(1,function(){return"popup"},data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\">\n    <span class=\"icon-",(helper=helpers.level)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.level,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"></span>\n    <div>\n        ",stack1=(helper=helpers.dompurify||depth0&&depth0.dompurify,options={hash:{},data:data},helper?helper.call(depth0,depth0&&depth0.msg,options):helperMissing.call(depth0,"dompurify",depth0&&depth0.msg,options)),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n    <span title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Close message",options):helperMissing.call(depth0,"__","Close message",options)))+"\" class=\"icon-close\" data-close=\":parent .feedback\"></span>\n</div>\n",buffer}),currents=[],levels=["info","success","warning","danger","error"],defaultOptions={timeout:{info:2e3,success:2e3,warning:4e3,danger:4e3,error:8e3},wrapLongWordsAfter:40,encodeHtml:!0,popup:!0},feedbackFactory=function($container,config){var feedback;if($container&&$container.length||($container=$$1("#feedback-box")),!$container.length)throw new TypeError("The feedback needs to belong to an existing container");return feedback=component({message:function(level,msg,params,options){var displayedMessage=msg;return level&&_.contains(levels,level)||(level="info"),_.isPlainObject(params)&&(options=params,params=[]),this.config=_.defaults(options||{},this.config),this.config.level=level,this.config.encodeHtml&&(displayedMessage=encode.html(displayedMessage)),this.config.wrapLongWordsAfter&&(displayedMessage=wrapLongWords(displayedMessage,this.config.wrapLongWordsAfter)),_.isArray(params)&&params.length&&(displayedMessage=format.apply(format,[displayedMessage].concat(params))),this.config.msg=displayedMessage,this},info:function(msg,params,options){return this.message("info",msg,params,options).open()},success:function(msg,params,options){return this.message("success",msg,params,options).open()},warning:function(msg,params,options){return this.message("warning",msg,params,options).open()},danger:function(msg,params,options){return this.message("danger",msg,params,options).open()},error:function(msg,params,options){return this.message("error",msg,params,options).open()},open:function(){return _(currents).reject(this).invoke("close"),this.display()},close:function(){this.is("rendered")&&this.destroy()},display:function(){return this.is("rendered")?this.show():this.render($container),this}},defaultOptions),feedback.setTemplate(tpl).on("init",function(){this.config.id="feedback-"+(currents.length+1),currents.push(this),$container.trigger("create.feedback")}).on("render",function(){var self=this,$component=this.getElement(),$closer=$$1(".icon-close",$component),timeout=_.isPlainObject(this.config.timeout)?this.config.timeout[this.config.level]:this.config.timeout;$closer.off("click").on("click",function(e){e.preventDefault(),self.destroy()}),_.isNumber(timeout)&&0<timeout&&_.delay(function(){self.close()},timeout),$container.trigger("display.feedback")}).on("destroy",function(){$container.trigger("close.feedback"),_.remove(currents,this)}).init(config)};return feedbackFactory}),define("ui/taskQueue/taskQueueModel",["jquery","lodash","core/eventifier","core/polling","core/dataProvider/request","ui/feedback","jquery.fileDownload"],function($,_,eventifier,polling,request,feedback){'use strict';function hasSameState(task1,task2){if(task1.status===task2.status)return!0;return!("created"!==task1.status&&"in_progress"!==task1.status)&&("created"===task2.status||"in_progress"===task2.status)}function taskQueueModel(config){var singlePollings={},getPollSingleIntervals=function(){if(config.pollSingleIntervals&&_.isArray(config.pollSingleIntervals))return _.cloneDeep(config.pollSingleIntervals)},getPollAllIntervals=function(){if(config.pollAllIntervals&&_.isArray(config.pollAllIntervals))return _.cloneDeep(config.pollAllIntervals)},model,_cache;return config=_.defaults(config||{},_defaults),model=eventifier({setEndpoints:function(urls){return _.assign(config.url,urls||{}),this},get:function(taskId){var status;if(!config.url||!config.url.get)throw new TypeError("config.url.get is not configured while get() is being called");return status=request(config.url.get,{taskId:taskId},"GET",{},!0).then(function(taskData){return taskData&&taskData.status?(_cache?_cache[taskData.id]?!hasSameState(_cache[taskData.id],taskData)&&model.trigger("singletaskstatuschange",taskData):model.trigger("singletaskadded",taskData):_cache={},_cache[taskData.id]=taskData,taskData):Promise.reject(new Error("failed to get task data"))}),status.catch(function(err){model.trigger("error",err)}),status},getCached:function(taskId){return _cache&&_cache[taskId]?Promise.resolve(_cache[taskId]):this.get(taskId)},getAll:function(){var status;if(!config.url||!config.url.all)throw new TypeError("config.url.all is not configured while getAll() is being called");return status=request(config.url.all,{limit:100},"GET",{},!0).then(function(taskData){var newCache={};return taskData?(_cache?(_.forEach(taskData,function(task){var id=task.id;_cache[id]?!hasSameState(_cache[id],task)&&model.trigger("multitaskstatuschange",task):model.trigger("multitaskadded",task),newCache[id]=task}),_.forEach(_.difference(_.keys(_cache),_.keys(newCache)),function(id){model.trigger("taskremoved",_cache[id])})):_.forEach(taskData,function(task){newCache[task.id]=task}),_cache=newCache,taskData):Promise.reject(new Error("failed to get all task data"))}),status.catch(function(err){model.trigger("error",err)}),status},archive:function(taskId){var status;if(!config.url||!config.url.archive)throw new TypeError("config.url.archive is not configured while archive() is being called");return status=request(config.url.archive,{taskId:taskId},"GET",{},!0),status.catch(function(res){model.trigger("error",res)}),status},pollAll:function(immediate){var self=this,loop=0,pollingIntervals=getPollAllIntervals(),_updateInterval=function(pollingInstance){var pollingInterval;loop?loop--:(pollingInterval=pollingIntervals.shift(),pollingInterval&&"undefined"!=typeof pollingInterval.iteration&&pollingInterval.interval&&(loop=pollingInterval.iteration,pollingInstance.setInterval(pollingInterval.interval)))};if(!config.url||!config.url.all)throw new TypeError("config.url.all is not configured while pollAll() is being called");return this.globalPolling?(this.globalPolling.start(),this.trigger("pollAllStart")):(this.globalPolling=polling({action:function(){var done=this.async(),statusArr;model.getAll().then(function(taskDataArray){return model.trigger("pollAll",taskDataArray),statusArr=_.map(taskDataArray,"status"),-1===statusArr.indexOf("in_progress")&&-1===statusArr.indexOf("created")?done.reject():void(_updateInterval(self.globalPolling),done.resolve())}).catch(function(){done.reject()})}}),_updateInterval(this.globalPolling),this.globalPolling.start(),this.trigger("pollAllStart")),immediate&&this.globalPolling.next(),model},pollAllStop:function(){return this.globalPolling&&(this.globalPolling.stop(),this.trigger("pollAllStop")),this},pollSingle:function(taskId){var self=this,loop=0,pollingIntervals=getPollSingleIntervals(),_updateInterval=function(pollingInstance){var pollingInterval;return loop?(loop--,!0):(pollingInterval=pollingIntervals.shift(),!!(pollingInterval&&pollingInterval.iteration&&pollingInterval.interval)&&(loop=pollingInterval.iteration,pollingInstance.setInterval(pollingInterval.interval),!0))};if(!config.url||!config.url.get)throw new TypeError("config.url.get is not configured while pollSingle() is being called");return singlePollings[taskId]&&singlePollings[taskId].stop(),new Promise(function(resolve){var poll=polling({action:function(){var done=this.async();self.get(taskId).then(function(taskData){"completed"===taskData.status||"failed"===taskData.status?(poll.stop(),self.trigger("pollSingleFinished",taskId,taskData),resolve({finished:!0,task:taskData})):_updateInterval(poll)?(self.trigger("pollSingle",taskId,taskData),done.resolve()):(self.trigger("pollSingleFinished",taskId,taskData),resolve({finished:!1,task:taskData}))}).catch(function(){done.reject()})}});_updateInterval(poll),singlePollings[taskId]=poll.start(),self.trigger("pollSingleStart",taskId)})},pollSingleStop:function(taskId){return singlePollings&&singlePollings[taskId]&&(singlePollings[taskId].stop(),this.trigger("pollSingleStop",taskId)),this},create:function(url,data){var self=this,taskCreate;return taskCreate=request(url,data,"POST",{},!0).then(function(creationResult){return creationResult&&creationResult.task&&creationResult.task.id?(self.trigger("created",creationResult),self.pollSingle(creationResult.task.id).then(function(result){return creationResult.extra&&(result.extra=creationResult.extra),result.finished?self.trigger("fastFinished",result):self.trigger("enqueued",result),result})):Promise.reject(new Error("failed to get task data"))}),taskCreate.catch(function(err){model.trigger("error",err)}),taskCreate},download:function(taskId){if(!config.url||!config.url.download)throw new TypeError("config.url.download is not configured while download() is being called");return new Promise(function(resolve,reject){$.fileDownload(config.url.download,{httpMethod:"POST",data:{taskId:taskId},successCallback:function(result){resolve(result)},failCallback:function(err){reject(err)}})})},redirect:function(taskId){return this.getCached(taskId).then(function(taskData){var redirectUrl=(taskData||{}).redirectUrl;if(!redirectUrl)throw new TypeError("config.redirectUrl is not configured while redirect() is being called");if(0!==redirectUrl.indexOf("http"))throw new TypeError("redirectUrl does not look like a proper url: "+redirectUrl);return request(taskData.redirectUrl)}).then(function(response){_.isEmpty(response)||(window.location.href=response)}).catch(function(err){throw err&&202===err.code&&err.response&&err.response.errorMessage&&feedback().error(err.response.errorMessage),err})}}),model}$=$&&$.hasOwnProperty("default")?$["default"]:$,_=_&&_.hasOwnProperty("default")?_["default"]:_,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier["default"]:eventifier,polling=polling&&polling.hasOwnProperty("default")?polling["default"]:polling,request=request&&request.hasOwnProperty("default")?request["default"]:request,feedback=feedback&&feedback.hasOwnProperty("default")?feedback["default"]:feedback;var _defaults={url:{get:"",archive:"",all:"",download:""},pollSingleIntervals:[{iteration:4,interval:1e3}],pollAllIntervals:[{iteration:10,interval:5e3},{iteration:0,interval:1e4}]};return taskQueueModel}),define("ui/taskQueue/taskQueue",["util/url","ui/taskQueue/taskQueueModel"],function(urlHelper,taskQueueModelFactory){'use strict';urlHelper=urlHelper&&urlHelper.hasOwnProperty("default")?urlHelper["default"]:urlHelper,taskQueueModelFactory=taskQueueModelFactory&&taskQueueModelFactory.hasOwnProperty("default")?taskQueueModelFactory["default"]:taskQueueModelFactory;var taskQueue=taskQueueModelFactory({url:{get:urlHelper.route("get","TaskQueueWebApi","tao"),archive:urlHelper.route("archive","TaskQueueWebApi","tao"),all:urlHelper.route("getAll","TaskQueueWebApi","tao"),download:urlHelper.route("download","TaskQueueWebApi","tao")},pollSingleIntervals:[{iteration:3,interval:1e3}],pollAllIntervals:[{iteration:1,interval:8e3},{iteration:0,interval:5e3}]});return taskQueue}),define("taoTaskQueue/controller/main",["jquery","taoTaskQueue/component/manager/manager","ui/taskQueue/taskQueue"],function($,taskQueueManagerFactory,taskQueue){'use strict';return{start:function start(){var taskManager=taskQueueManagerFactory({replace:!0}).on("remove",function(taskId){return taskQueue.archive(taskId)}).on("report",function(taskId){taskQueue.get(taskId).then(function(task){return taskManager.showDetail(task)})}).on("download",function(taskId){return taskQueue.download(taskId)}).on("redirect",function(taskId){return taskQueue.redirect(taskId)}).on("listclearfinished",function(){taskQueue.pollAllStop().archive("all").then(function(){return taskQueue.pollAll()})}).render($("#taskqueue").parent()).hide();taskQueue.on("taskcreated",function(data){taskManager.list.is("hidden")?taskManager.absorbBurst(data.sourceDom,[0,300,600]).then(function(){taskManager.addNewTask(data.task),taskQueue.pollAll()}):(taskManager.addNewTask(data.task,!0),taskQueue.pollAll())}).on("multitaskstatuschange",function(){return taskManager.pulse()}).on("pollAll",function(tasks){taskManager.is("hidden")&&taskManager.show(),taskManager.loadData(tasks)}).pollAll(!0)}}}),define("taoTaskQueue/controller/routes",[],function(){'use strict';return{Main:{actions:{index:"taoTaskQueue/controller/main"}}}}),function(c){var d=document,s=d.createElement("style");s.type="text/css",d.getElementsByTagName("head")[0].appendChild(s),s.styleSheet?s.styleSheet.cssText=c:s.appendChild(d.createTextNode(c))}("/*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n/* Style of advanced components */\n/* toggler */\n.toggler:after {\n    margin-left: 3px;\n    position: relative;\n    top: 2px;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e611\";\n}\n\n.toggler.opened:after {\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e610\";\n}\n\n.toggled {\n    display: none;\n}\n\n/* Adder */\n.adder:before {\n    margin-right: 5px;\n    font-size: 10.5px;\n    font-size: 1.05rem;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e636\";\n}\n\n/* Closer / Deleter */\n.closer:before, .deleter:before {\n    margin-right: 5px;\n    font-size: 10.5px;\n    font-size: 1.05rem;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e637\";\n}\n\n.undobox {\n    display: block;\n    position: fixed;\n    top: 50px;\n    left: 50%;\n    margin-left: -200px;\n    width: 400px;\n    z-index: 100005;\n}\n\n/* Incrementer and duration */\ninput[data-increment], input.duration-ctrl {\n    width: 40px !important;\n    min-width: 40px !important;\n    text-align: right;\n}\n\n.duration-ctrl-wrapper, .incrementer-ctrl-wrapper {\n    position: relative;\n    display: inline-block;\n    border: 1px solid #ddd;\n    border-radius: 2px;\n    border-radius: 2px;\n}\n\n.duration-ctrl-wrapper .incrementer, .incrementer-ctrl-wrapper .incrementer {\n    text-align: right;\n    border: none;\n    padding-right: 18px;\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl {\n    border-left: 1px #ddd solid;\n    display: inline-block;\n    height: 100%;\n    position: absolute;\n    right: 0;\n    top: 0;\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a {\n    outline: 0 !important;\n    cursor: pointer;\n    display: inline-block;\n    line-height: 13px;\n    color: #222;\n    background: #f3f1ef;\n    padding: 0 4px 0 4px;\n    font-size: 10.5px;\n    font-size: 1.05rem;\n    position: absolute;\n    right: 0;\n    height: 50%;\n    text-align: center;\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.inc, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.inc {\n    top: 0;\n    border-top-right-radius: 2px;\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.dec, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.dec {\n    top: 50%;\n    border-bottom-right-radius: 2px;\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.inc:before, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.inc:before {\n    position: relative;\n    bottom: 0px;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e610\";\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.dec:before, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.dec:before {\n    position: relative;\n    top: 0px;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e611\";\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a:hover, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a:hover {\n    background-color: #3e7da7;\n    color: white;\n}\n\n.duration-ctrl-wrapper ~ .separator {\n    padding: 0 3px;\n    text-align: center;\n    opacity: .7;\n}\n\n/* InPlacer */\n[data-in-place], .inplace {\n    cursor: pointer;\n    min-height: 1em;\n}\n\n[data-in-place] input, .inplace input {\n    cursor: auto;\n}\n\n[data-in-place]:hover, .inplace:hover {\n    border: dotted 1px #3e7da7;\n}\n\n/* ListBox  */\nul.listbox {\n    margin: .1em 0;\n    padding: 0;\n    list-style-type: none;\n    display: block;\n}\n\nul.listbox > li {\n    white-space: no-wrap;\n    position: relative;\n    min-width: 75%;\n    border: solid 1px #ddd;\n    border-bottom-width: 0;\n    vertical-align: top;\n    margin: 0;\n    padding: .3em 2em .3em .2em;\n    background-color: #f3f1ef;\n    min-height: 1.5em;\n}\n\nul.listbox > li > .closer, ul.listbox > li > .deleter {\n    position: absolute;\n    right: 5px;\n    top: 0;\n}\n\nul.listbox > li:first-child {\n    border-radius: 2px 2px 0 0;\n}\n\nul.listbox > li:last-child {\n    border-radius: 0 0 2px 2px;\n    border-bottom-width: 1px;\n}\n\nul.listbox > li.placeholder {\n    background: none;\n    margin: .5em;\n    opacity: 0.6;\n}\n\n/* Modal styles */\n.modal {\n    background-color: white;\n    border: 1px solid #ddd;\n    box-shadow: 3px 3px 5px #666666;\n    height: auto;\n    opacity: 0;\n    top: -1000px;\n    padding: 40px;\n    position: fixed;\n    z-index: 105002;\n    margin: auto;\n    left: 0;\n    right: 0;\n    overflow: hidden;\n}\n\n.modal .modal-close {\n    position: absolute;\n    right: 12px;\n    top: 10px;\n    cursor: pointer;\n    font-weight: bold;\n    color: #222;\n}\n\n.modal .modal-close:hover {\n    opacity: 0.6;\n}\n\n.modal .modal-close .icon-close {\n    font-size: 20px;\n    font-size: 2rem;\n}\n\n.modal button.modal-close {\n    color: #222 !important;\n    background-color: transparent;\n    padding: 0;\n    height: 20px;\n}\n\n.modal button.modal-close .icon-close {\n    padding: 0;\n}\n\n.modal .modal-body h4 {\n    font-size: 16px;\n    font-size: 1.6rem;\n    margin-top: 0;\n    margin-bottom: 8px;\n}\n\n.modal .modal-body .content, .modal .modal-body .message {\n    margin-bottom: 8px;\n}\n\n.modal .modal-body .buttons {\n    top: 16px;\n    position: relative;\n}\n\n.modal .modal-body .buttons button {\n    border-radius: 2px;\n    margin-left: 8px;\n    height: 36px;\n    text-shadow: none;\n    text-transform: uppercase;\n    color: #0e5d91 !important;\n    background: none;\n}\n\n.modal .modal-body .buttons button:focus, .modal .modal-body .buttons button:hover {\n    background: #dbe7ef;\n}\n\n.modal[class^=\"icon-\"]:before, .modal[class*=\" icon-\"]:before {\n    font-size: 44px;\n    font-size: 4.4rem;\n    color: #0e5d91;\n    position: absolute;\n}\n\n.modal[class^=\"icon-\"].icon-result-nok:before, .modal[class*=\" icon-\"].icon-result-nok:before {\n    color: #ba122b;\n}\n\n.modal[class^=\"icon-\"].icon-warning:before, .modal[class*=\" icon-\"].icon-warning:before {\n    color: #c96043;\n}\n\n.modal[class^=\"icon-\"].icon-result-ok:before, .modal[class*=\" icon-\"].icon-result-ok:before {\n    color: #0e914b;\n}\n\n.modal[class^=\"icon-\"].error:before, .modal[class*=\" icon-\"].error:before {\n    color: #ba122b;\n}\n\n.modal[class^=\"icon-\"].danger:before, .modal[class*=\" icon-\"].danger:before {\n    color: #c96043;\n}\n\n.modal[class^=\"icon-\"].warning:before, .modal[class*=\" icon-\"].warning:before {\n    color: #d8ae5b;\n}\n\n.modal[class^=\"icon-\"].info:before, .modal[class*=\" icon-\"].info:before {\n    color: #0e5d91;\n}\n\n.modal[class^=\"icon-\"].success:before, .modal[class*=\" icon-\"].success:before {\n    color: #0e914b;\n}\n\n.modal[class^=\"icon-\"] .modal-body, .modal[class*=\" icon-\"] .modal-body {\n    font-family: \"Source Sans Pro\", sans-serif !important;\n    line-height: 1.4;\n    margin-left: 8.5rem;\n}\n\n.modal-bg {\n    background: none repeat scroll 0 0 black;\n    opacity: 0.45;\n    -ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity=45)\";\n    filter: alpha(opacity=45);\n    display: none;\n    position: fixed;\n    height: 100%;\n    width: 100%;\n    left: 0;\n    top: 0;\n    z-index: 100001;\n    overflow: hidden;\n}\n\n/* Button groups */\nul[data-button-group], ul.button-group {\n    list-style-type: none;\n    padding: 0;\n    background-color: white;\n    border: 1px solid #ddd;\n    border-radius: 1px;\n    margin: 0 2px 2px 0;\n    display: inline-block;\n    border-radius: 2px;\n    font-size: 12px;\n    font-size: 1.2rem;\n}\n\nul[data-button-group] > li, ul.button-group > li {\n    border: 0 none;\n    color: #222;\n    cursor: pointer;\n    display: inline-block;\n    float: left;\n    min-width: 26px;\n    padding: 4px 6px;\n    text-align: center;\n    text-decoration: none !important;\n}\n\nul[data-button-group] > li.active, ul.button-group > li.active {\n    color: white;\n    background-color: #0e5d91;\n    transition: all 0.4s ease;\n}\n\nul[data-button-group] > li:hover, ul.button-group > li:hover {\n    color: white;\n    background-color: #3e7da7;\n    transition: all 0.4s ease;\n}\n\nul[data-button-group] > li.separator, ul.button-group > li.separator {\n    background-color: #ddd;\n    float: left;\n    height: 18px;\n    margin: 5px 2px 0 2px;\n    width: 1px;\n    min-width: 1px;\n    padding: 0;\n}\n\nul[data-button-group] > li[class^=\"icon-\"], ul[data-button-group] > li[class*=\" icon-\"], ul.button-group > li[class^=\"icon-\"], ul.button-group > li[class*=\" icon-\"] {\n    height: 16px;\n    margin-top: 1px;\n    width: 16px;\n    padding-top: 2px;\n}\n\n/* Media Preview */\n.previewer {\n    background-color: white;\n    margin: 5px;\n    min-width: 280px;\n    min-height: 200px;\n    text-align: center;\n}\n\n.previewer .nopreview {\n    color: #ddd;\n    text-align: center;\n    font-size: 20px;\n    font-size: 2rem;\n}\n\n.previewer .nopreview:before {\n    font-size: 60px;\n    font-size: 6rem;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e670\";\n    display: block !important;\n}\n\n/* Progress bar */\n.progressbar {\n    height: 2em;\n    text-align: left;\n    border: none;\n    height: 0.8em;\n    background-color: white;\n    border: 1px solid #ddd;\n}\n\n.progressbar > span {\n    height: 100%;\n    border: none;\n    background-color: #3e7da7;\n    display: block;\n    color: white;\n    transition: width 0.4s ease 0s;\n}\n\n.progressbar.info > span {\n    background-color: #0e5d91;\n}\n\n.progressbar.success > span {\n    background-color: #0e914b;\n}\n\n.progressbar.warning > span {\n    background-color: #d8ae5b;\n}\n\n.progressbar.error > span {\n    background-color: #ba122b;\n}\n\n/*# sourceMappingURL=components.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.badge-component {\n    position: relative;\n}\n\n.badge-component .loader:not(.hidden) {\n    position: relative;\n    top: -1px;\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    animation: badge-component-rotate 1.4s infinite linear;\n    background: linear-gradient(left, #e6e6e6 10%, rgba(230, 230, 230, 0) 42%);\n    transform: translateZ(0);\n}\n\n@keyframes badge-component-rotate {\n    0% {\n        transform: rotate(0deg);\n    }\n    100% {\n        transform: rotate(360deg);\n    }\n}\n\n.badge-component .loader:not(.hidden):before {\n    width: 50%;\n    height: 50%;\n    background: #e6e6e6;\n    border-radius: 100% 0 0 0;\n    position: absolute;\n    top: 0;\n    left: 0;\n    content: '';\n}\n\n.badge-component .loader:not(.hidden):after {\n    background: #333333;\n    width: 75%;\n    height: 75%;\n    border-radius: 50%;\n    content: '';\n    margin: auto;\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n}\n\n.badge-component .badge {\n    background: #e6e6e6;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    -o-user-select: none;\n    user-select: none;\n    font-size: 12px;\n    font-size: 1.2rem;\n    width: 19px;\n    height: 19px;\n    border-radius: 50%;\n    position: absolute;\n    top: 2px;\n    left: 3px;\n    padding-top: 1px;\n    text-align: center;\n    display: inline-block;\n}\n\n.badge-component .badge.badge-info {\n    color: #e7eff4;\n    background: #3e7da7;\n}\n\n.badge-component .badge.badge-success {\n    color: #e7f4ed;\n    background: #3ea76f;\n}\n\n.badge-component .badge.badge-warning {\n    color: #faf0ee;\n    background: #d16c55;\n}\n\n.badge-component .badge.badge-error {\n    color: #f8e7ea;\n    background: #ba122b;\n}\n\n.badge-component .badge.icon-result-ok::before {\n    top: 3px;\n    position: relative;\n    color: blue;\n}\n\n.badge-component .badge-border {\n    background: #e6e6e6;\n    width: 21px;\n    height: 21px;\n    border-radius: 50%;\n    position: absolute;\n    top: 1px;\n    left: 2px;\n}\n\n/*# sourceMappingURL=badge.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.absorbable {\n    z-index: 1;\n    border-radius: 0%;\n    background: #e6e6e6;\n    opacity: 0;\n}\n\n.absorbable.animate {\n    transform: translateZ(0);\n    transition-timing-function: cubic-bezier(0.2, 0.6, 1, 0.4);\n    animation: absorbable-opacity 2s cubic-bezier(0.2, 0.6, 1, 0.4) 1;\n}\n\n@keyframes absorbable-opacity {\n    0% {\n        opacity: 0;\n    }\n    20% {\n        opacity: 0.3;\n        border-radius: 20%;\n    }\n    60% {\n        opacity: 0.9;\n    }\n    100% {\n        border-radius: 50%;\n    }\n}\n\n.absorbable .example {\n    display: grid;\n    transition: all 0.5s;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    background: linear-gradient(to bottom, white, black);\n}\n\n/*# sourceMappingURL=absorb.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.pulsable {\n    z-index: 1;\n    display: block;\n    border-radius: 50%;\n    position: absolute;\n    background: #e6e6e6;\n    width: 1px;\n    height: 1px;\n    top: 0px;\n    left: 0px;\n    box-shadow: 0 0 0 rgba(230, 230, 230, 0.6);\n}\n\n@keyframes pulsable-pulse {\n    0% {\n        box-shadow: 0 0 0 0 rgba(230, 230, 230, 0.6);\n    }\n    50% {\n        box-shadow: 0 0 0 200px rgba(230, 230, 230, 0);\n    }\n    100% {\n        box-shadow: 0 0 0 0 rgba(230, 230, 230, 0);\n    }\n}\n\n.pulsable.animate {\n    animation: pulsable-pulse 1s ease-out infinite;\n}\n\n/*# sourceMappingURL=pulse.css.map */div.task-element{position:relative;background:#f3f1ef;padding:10px 20px;width:100%;height:70px;-webkit-transition:background, 2s, ease-out, 0s;-moz-transition:background, 2s, ease-out, 0s;-ms-transition:background, 2s, ease-out, 0s;-o-transition:background, 2s, ease-out, 0s;transition:background, 2s, ease-out, 0s}div.task-element.highlight{background:white;-webkit-transition:background, 0s, ease-out, 0s;-moz-transition:background, 0s, ease-out, 0s;-ms-transition:background, 0s, ease-out, 0s;-o-transition:background, 0s, ease-out, 0s;transition:background, 0s, ease-out, 0s}div.task-element .container-icon{position:absolute}div.task-element .container-icon .shape{display:inline-block;border-radius:50%;width:40px;height:40px;top:2px;position:relative}div.task-element .container-icon .shape [class^=\"icon-\"],div.task-element .container-icon .shape [class*=\" icon-\"]{font-size:20px;font-size:2rem;position:relative;top:9px;left:12px;text-shadow:none}div.task-element .container-icon .shape .icon-export,div.task-element .container-icon .shape .icon-import,div.task-element .container-icon .shape .icon-connect{left:10px}div.task-element .container-icon .shape .icon-property-advanced,div.task-element .container-icon .shape .icon-result-ok,div.task-element .container-icon .shape .icon-result-nok{top:10px;left:10px}div.task-element.in_progress .container-icon .shape{background:#0e5d91}div.task-element.in_progress .container-icon .shape [class^=\"icon-\"],div.task-element.in_progress .container-icon .shape [class*=\" icon-\"]{color:#e7eff4}div.task-element.in_progress .action-group.action-bottom [data-role=\"notify\"]{display:none}div.task-element.in_progress .action-group.action-top [data-role=\"remove\"]{display:none}div.task-element.completed .container-icon .shape{background:#0e914b}div.task-element.completed .container-icon .shape [class^=\"icon-\"],div.task-element.completed .container-icon .shape [class*=\" icon-\"]{color:#e7f4ed}div.task-element.completed .action-group.action-bottom [data-role=\"download\"],div.task-element.completed .action-group.action-bottom [data-role=\"report\"],div.task-element.completed .action-group.action-bottom [data-role=\"redirect\"]{display:inline-block}div.task-element.failed .container-icon .shape{background:#ba122b}div.task-element.failed .container-icon .shape [class^=\"icon-\"],div.task-element.failed .container-icon .shape [class*=\" icon-\"]{color:#f8e7ea}div.task-element.failed .action-group.action-bottom [data-role=\"download\"],div.task-element.failed .action-group.action-bottom [data-role=\"report\"],div.task-element.failed .action-group.action-bottom [data-role=\"redirect\"]{display:inline-block}div.task-element .container-text{padding-top:0px;margin-left:60px;width:240px}div.task-element .container-text .label{min-height:22px;max-height:38px;overflow:hidden;color:#222}div.task-element .container-text .time{color:#92918f;font-size:12px;font-size:1.2rem}div.task-element .action-group{position:absolute}div.task-element .action-group [class^=\"icon-\"],div.task-element .action-group [class*=\" icon-\"]{font-size:16px;font-size:1.6rem;background-color:transparent;width:20px;height:20px;display:inline-block;padding-left:4px;margin-left:5px;cursor:pointer}div.task-element .action-group [class^=\"icon-\"]:hover,div.task-element .action-group [class*=\" icon-\"]:hover{opacity:0.6}div.task-element .action-group.action-top{top:6px;right:14px}div.task-element .action-group.action-bottom{bottom:6px;right:12px}div.task-element .action-group.action-bottom [class^=\"icon-\"],div.task-element .action-group.action-bottom [class*=\" icon-\"]{display:none}\n\n/*# sourceMappingURL=element.css.map */div.task-detail-element{position:relative;padding:10px 20px;width:600px;min-height:250px;background:#f3f1ef}div.task-detail-element .detail-description .label{margin-right:4px;color:#222;font-weight:bold}div.task-detail-element .detail-description .time{margin-left:4px;color:#92918f;font-size:12px;font-size:1.2rem}div.task-detail-element .detail-body{max-height:500px;overflow-y:auto;padding:10px 0}div.task-detail-element .action-top{position:absolute;top:9px;right:14px}div.task-detail-element .action-top [class^=\"icon-\"],div.task-detail-element .action-top [class*=\" icon-\"]{font-size:16px;font-size:1.6rem;color:#222;background-color:transparent;width:20px;height:20px;display:inline-block;padding-left:4px;margin-left:5px;cursor:pointer}div.task-detail-element .action-top [class^=\"icon-\"]:hover,div.task-detail-element .action-top [class*=\" icon-\"]:hover{opacity:0.6}div.task-detail-element .no-detail{display:none}div.task-detail-element.noreport .no-detail{display:block;color:#92918f}\n\n/*# sourceMappingURL=report.css.map */div.task-listing{position:relative;cursor:default;padding-top:0px}div.task-listing div.box{position:relative;min-height:76px;min-width:360px;background:#f3f1ef;-webkit-box-shadow:0 3px 6px 0px rgba(0,0,0,0.6);-moz-box-shadow:0 3px 6px 0px rgba(0,0,0,0.6);-ms-box-shadow:0 3px 6px 0px rgba(0,0,0,0.6);-o-box-shadow:0 3px 6px 0px rgba(0,0,0,0.6);box-shadow:0 3px 6px 0px rgba(0,0,0,0.6);border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px}div.task-listing div.box .description{padding:2px 20px;background:#dbd9d7;color:#222;font-weight:bold;border-bottom:solid 1px #ddd;min-height:8px}div.task-listing div.box .arrow{-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg);border:1px #ddd solid;border-right:none;border-bottom:none;width:16px;height:16px;background:#dbd9d7;color:#222;position:absolute;right:14px;top:-9px}div.task-listing div.box ul.task-list{position:relative;top:0;left:0;right:0;opacity:1;padding:0 !important;border:none;max-height:460px;overflow:auto;background:#c2c1bf;position:relative}div.task-listing div.box ul.task-list li{position:relative;width:100%;max-height:100px;color:#222;background:#c2c1bf}div.task-listing div.box ul.task-list li:not(:last-child){border-bottom:solid 1px #dbd9d7}div.task-listing div.box ul.task-list li.inserting{max-height:0;-webkit-transition:max-height, .5s, ease-out, 0s;-moz-transition:max-height, .5s, ease-out, 0s;-ms-transition:max-height, .5s, ease-out, 0s;-o-transition:max-height, .5s, ease-out, 0s;transition:max-height, .5s, ease-out, 0s}div.task-listing div.box ul.task-list li.inserting .task-element{height:0px}div.task-listing div.box ul.task-list li.inserted{min-height:70px}div.task-listing div.box ul.task-list li .task-element{transform:scaleY(1);-webkit-transition:scaleY, .6s, ease-out, 0s;-moz-transition:scaleY, .6s, ease-out, 0s;-ms-transition:scaleY, .6s, ease-out, 0s;-o-transition:scaleY, .6s, ease-out, 0s;transition:scaleY, .6s, ease-out, 0s}div.task-listing div.box ul.task-list li .task-element.new-element{transform-origin:20% 0;transform:scaleY(0)}div.task-listing div.box .clear-box{text-align:center;border-top:solid 1px #ddd;background:#eceae8;padding:2px 0}div.task-listing div.box .clear-box .clear-all{text-decoration:none;color:#3e7da7}div.task-listing div.box .clear-box .clear-all:hover{text-decoration:underline;color:#0e5d91}div.task-listing div.box .empty-placeholder{width:100%;position:absolute;top:25px;padding:12px 20px;font-style:italic;color:#222}div.task-listing div.box .view-detail{display:none}div.task-listing.detail-view .box .task-list,div.task-listing.detail-view .box .clear-box{display:none}div.task-listing.detail-view .box .view-detail{display:block;position:relative}\n\n/*# sourceMappingURL=list.css.map */.task-manager-container{cursor:pointer;position:relative;width:40px;height:64px;background-color:transparent;padding:22px 8px 0px}.task-manager-container:hover{-webkit-transition:background-color 0.2s ease;-moz-transition:background-color 0.2s ease;-ms-transition:background-color 0.2s ease;-o-transition:background-color 0.2s ease;transition:background-color 0.2s ease;background-color:rgba(14,93,145,0.5);text-decoration:none}.dark-bar nav .settings-menu:hover ~ .persistent-menu .task-listing .box{box-shadow:none;border-color:#eee}.dark-bar nav .settings-menu:hover ~ .persistent-menu .task-listing .box .arrow{display:none}\n\n/*# sourceMappingURL=manager.css.map */"),define("taoTaskQueue/loader/taoTaskQueue.bundle",function(){});
//# sourceMappingURL=taoTaskQueue.min.js.map